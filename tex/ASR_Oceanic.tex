%USE XeLaTeX compiler!!

\documentclass[12pt,letterpaper]{article}
\usepackage[lmargin=1.2in,rmargin=1.2in,tmargin=1in,bmargin=1in]{geometry}
\usepackage[bf,tiny]{titlesec}
%\usepackage{fontspec,xltxtra,xunicode}
    	%\defaultfontfeatures{Mapping=tex-text}
%\usepackage[utf8]{inputenc}
%\usepackage[utf8]{fontenc}
%\setmainfont{Junicode}

\usepackage{setspace}
%\usepackage{gb4e}
\let\eachwordone=\it %italicise the first line of examples
\usepackage[sort]{natbib}
\bibpunct[: ]{(}{)}{,}{a}{}{,}
\usepackage{afterpage}
\usepackage{graphicx}

%%% your packages here; please use sparingly and for things you actually need (not for aesthetics)

% extra packages
\usepackage{placeins} %to enable float barriers
\usepackage{xeCJK} %for chinese characters
\usepackage[table,dvipsnames]{xcolor} %for specifying colors
\usepackage{amsmath} % for equations
\usepackage{authblk} % for author affiliation
\usepackage{booktabs} % for nice looking tables
\usepackage{longtable} %for tables stretching several pages
\usepackage{pdflscape} %for making things landscape
\usepackage{multirow} %merging rows in tables
\usepackage{rotating} %for sideways figures
\usepackage{caption} %for making subfigures
\usepackage{subcaption} %for making subfigures
\usepackage{newfloat} %making it possible to treat lists as floats
\usepackage{enumitem} %make it possible to have other enumerate items, like roman numerals

\usepackage{xr-hyper} 

\makeatletter

\newcommand*{\addFileDependency}[1]{% argument=file name and extension
\typeout{(#1)}% latexmk will find this if $recorder=0
% however, in that case, it will ignore #1 if it is a .aux or 
% .pdf file etc and it exists! If it doesn't exist, it will appear 
% in the list of dependents regardless)
%
% Write the following if you want it to appear in \listfiles 
% --- although not really necessary and latexmk doesn't use this
%
\@addtofilelist{#1}
%
% latexmk will find this message if #1 doesn't exist (yet)
\IfFileExists{#1}{}{\typeout{No file #1.}}
}\makeatother

\newcommand*{\myexternaldocument}[1]{%
\externaldocument{#1}%
\addFileDependency{#1.tex}%
\addFileDependency{#1.aux}%
}
%------------End of helper code--------------

% put all the external documents here!

\myexternaldocument{ASR_Oceanic_appendix}


%for nice looking links
\usepackage{hyperref}

\hypersetup{
    colorlinks=true, %set true if you want colored links
    linktoc=all,     %set to all if you want both sections and subsections linked
    linkcolor=violet,  %choose some color if you want links to stand out
            urlcolor=blue,
            citecolor=Thistle,
}

%define special colors for fonts and tables
\definecolor{spec_color_blue}{HTML}{7D81F5}
\definecolor{spec_color_lightgreen}{HTML}{81F093}
\definecolor{spec_color_darkgreen}{HTML}{0B8C1F}
\definecolor{spec_color_orange}{HTML}{FFB87A}
\definecolor{spec_color_red}{HTML}{FFD9E0}
\definecolor{spec_color_yellow}{HTML}{FCFFA8}

%making chinese characters possible


%%% preamble
\title{Disentangling Ancestral State Reconstruction in historical linguistics: Comparing classic approaches and new methods using Oceanic grammar}
\author[1]{Hedvig Skirgård}
\affil[1]{Department of Linguistic and Cultural Evolution, Max Planck Institute for Evolutionary Anthropology. Leipzig, Germany.}



\begin{document}
%\def\code#1{\texttt{#1}}

\thispagestyle{empty}


\maketitle
\thispagestyle{empty}


%\textcolor{red}{This is a first draft based on the chapter text. I've modified it, and I'm in the process of modifying further. }



\begin{abstract}

Ancestral State Reconstruction (ASR) is an essential part of historical linguistics (HL). Conventional ASR in HL relies on three core principles: fewest changes on the tree,  plausibility of changes and plausibility of the resulting combinations of features in proto-languages. This approach has some problems, in particular the definition of what is plausible and the disregard of branch lengths. This study compares the classic approach of ASR to computational tools (Maximum Parsimony and Maximum Likelihood), conceptually and practically. Computational models have the advantage of being more transparent, consistent and replicable, and the disadvantage of lacking nuanced knowledge and context. Using data from the structural database Grambank, I compare reconstructions of the grammar of ancestral Oceanic languages from the historical linguistics literature to those achieved by computational means. The results show that there is a high degree of agreement between manual and computational approaches, with a tendency for classical HL to ignore branch lengths. Explicitly taking branch lengths into account is more conceptually sound; as such the field of historical linguistics should engage in improving methods in this direction. A combination of computational methods and qualitative knowledge is possible in the future and would be of great benefit.

%Reconstruction is an essential part of historical linguistics. Conventional reconstruction in historical linguistics (HL) infers states in proto-languages by three core principles: assume the fewest changes on the tree, assume plausible changes, and assume plausible combinations of features in proto-languages. However, there is no clear consensus on how to weigh the principles against each other, and many studies are not fully transparent regarding how precisely the principles are applied. This allows for subjective differences between studies which are hard to discern and replicate. This study aims to better understand the toolbox of historical linguistics in general and Oceanic grammatical history in particular by comparing the reconstruction of structural features by classical historical linguists to computational reconstructions with explicit and transparent mechanisms: Maximum Parsimony (MP) and Marginal Maximum Likelihood (ML). MP is similar to conventional HL in that it infers the fewest amounts of changes along the tree. ML on the other hand infers rates of change based on the distribution of values and takes into account branch lengths. In addition, we explore an even simpler method of reconstruction, which ignores tree structure and takes into account only the most common feature in the daughter languages. The results indicate that all methods applied achieve a high level of concordance with predictions from historical linguistics, which lets us understand the mechanisms of CM better. The more methodology is made explicit, the better off we are as a field.

% ste says: https://www.facebook.com/alan.elliott.125/posts/pfbid022H8vUKQxqKEE1e64DTcaJqXLDdruJEP8kpj5M89UtV6z8HHSTTTtYJVMVhZuBhsHl

%There are two possible
%This could indicate that historical linguists mainly make statements about the grammar of Oceanic proto-languages where they have a high amount of certainty, 

%The results show that CM produces reconstructions that are most similar to those generated by MP or MC. This suggests that, at least for this sample of languages and features, CM does not appear to take branch lengths into account. The methodological drawbacks of using MP and MC imply that we should possibly re-evaluate the way reconstruction is done in historical linguistics and take into account insights from new approaches, such as ML which makes sound assumptions which are likely to give better estimations of the state of proto-languages.


%Historical linguists use the comparative method to find sound correspondences, to reconstruct unattested forms and structures of proto-languages and to propose subgroups. Part of this process can be done computationally with new methods such as Maximum Likelihood. Such methods are more explicit in terms of the assumed underlying tree structure, data weighting etc. Studies in historical linguistics are not always as explicit. In this paper, we attempt to reconstruct the assumptions and implicit inner workings of the comparative method by comparing reconstructions made "by hand" by historical linguists to those derived from computational means. We also address areas of conflicts where different historical linguistics scholars disagree and evaluate what we can learn from computational methods regarding these issues. We estimate the grammatical structures of Oceanic languages in particular, using the Grambank dataset and trees published by Glottolog and \citet{grayetal_2009}. The results show that classical historical linguistics, for this dataset and trees, appears to mainly be an application of Maximum Parsimony, and we further discuss what this implies for the field of reconstruction of proto-languages. In the cases where historical linguists disagree, the results further show that the most likely scenario is that proto-polynesian was ergative.
\end{abstract}


\noindent\textbf{Keywords:} Oceanic languages, classical ancestral state reconstruction, computational ancestral state reconstruction, grammar


%\tableofcontents

%\newpage


\section{Introduction}
\label{acr:intro}
Historical linguistics (HL) offers us a unique and insightful window into our human past. By reconstructing the paths languages take, we can learn about our history and infer the migration paths of people and cultures. By reconstructing the words, sounds and grammar of ancient languages, we can learn about communities long gone. Insights from HL have contributed to great strides in our understanding of human history since its inception. The field has established methods that have enabled us to classify languages into language families and reconstruct words and sounds of proto-languages (unobserved ancestors of observed languages). Conclusions from HL are also influential in other historical sciences, for example archaeology (cf. \citealt[S364]{bellwood2011holocene}).

HL-researchers make use of a wealth of knowledge not only of the languages themselves but also the cultures, societies and history of the regions they research. At times, it is difficult to be explicit about all the background information and context that goes into an analytical steps in HL -- which makes it hard for someone else to replicate and examine the study thoroughly.

In this study, I focus on one particular subset of the HL toolbox -- the inference of earlier states of languages -- and outline how computational approaches can be a complement that serves to increase speed, transparency and consistency. I discuss the underlying mechanisms of the conventional ``manual'' approaches to reconstruction in HL and compare the conceptual framework to computational alternatives. As a practical example, we compare reconstructions of Oceanic grammar. This study makes visible the opportunities for methodological expansion presented by incorporating computational approaches into mainstream HL.

Historical linguists typically engage in three different tasks simultaneously: (a) the identification of cognates and sound correspondences in languages; (b) the inference of subgrouping (networks/trees);\footnote{cf. how biological cladistics finds relationships between species based on shared derived characteristics from common ancestors \citep[16--17]{maclaurin2008biodiversity}.} and (c) the inference of sounds/forms/patterns in proto-languages (Ancestral State Reconstruction = ASR). In conventional approaches in HL, these three tasks are done at the same time and inform each other -- they are necessarily interlinked. However, in historical analysis of biology and cultural evolution, these tasks are more separated out. Figure \ref{fig:HL_tasks} illustrates these three tasks for four different kinds of material: words (sounds and cognates), grammar, genes and biological features. The arrows indicate task workflow, with information on words leading to the construction of trees, which in turn enables ASR on lexicon and grammar. This is mirrored in the biological sciences, with genomic data serving as the bases for the trees, which then make ASR possible. The feedback loop between tree construction and ASR in the classical analysis of cognates and sound correspondences is illustrated with circular arrows. The same is true of biological traits, where biologists take care to avoid predicting impossible ancestral states \citep{schulmeister2004comparative} and may therefore revise their trees if these occur. Furthermore, both linguists and biologists may return and re-examine their original classification of their data (task a; cognate coding, sample labelling, sequence alignment etc.) given the outcome of ASR (task c; cf. re-estimating sequence alignment in genetics while estimating trees; \citealt{Redelings_2021_BAli-Phy}). The three tasks are not necessarily independent in the biological sciences, but it is possible to carry them out separately, and the links between them are explicit. 

\begin{sidewaysfigure}[p]
\centering
\includegraphics[width=22cm]{illustrations/ASR_HL_explainer_ill.png}
\caption{The three tasks involved in the historical reconstruction of linguistic matter (words \& sounds), patterns (grammar) and biological traits. The tasks follow each other as indicated by the arrows. The butterfly illustrations are modified from \citet{savage2009single}}
\label{fig:HL_tasks}
\end{sidewaysfigure}

It is clear from the historical linguistics literature that linking these three tasks to each other is useful -- for example, revising a tree when a reconstructed state does not make sense, classifying cognates of extant languages based on knowledge derived from elsewhere in the tree, etc. However, there are disadvantages as well. The first among these is the difficulty of providing a highly transparent methodology. This kind of labour involves a vast amount of knowledge and careful decisions, and it is not easy to make all of them explicit and accessible. 

In this paper, we focus specifically on only the third task of ASR. Specifically, this paper concerns ASR of structural data, grammatical variables of Oceanic languages from a large-scale typological database (Grambank v1.0; \citealt{grambank_release}). In addition to increasing transparency, quantitative approaches to ASR also have the benefit of speed. By interrogating the conventional methods of ASR in HL and comparing the principles and outcomes of such conventional methods to various computational approaches, it is possible to evaluate the levels of agreement between the two. In so doing, it becomes possible to improve on transparency and include into historical linguists convenient tools that can effectivize part of the labour.

One of the major differences between ASR in conventional historical linguistics and in biological and cultural evolution is the evaluation of appropriate data for phylogenetic analysis. Studies in historical linguistics typically require that the input data satisfy the Double Cognacy Criterion \citep{walkden_2013}, i.e. that the cognate sounds must occur in words which are themselves also cognates. This is relevant both for the construction of trees (task b in Figure \ref{fig:HL_tasks}) and ASR (task c). It is difficult to apply this test to non-vocabulary data because it is not clear what what corresponds to words and phonemes are in structural data such that this criteria can be satisfied. 

In cultural evolution and biology on the other hand, data are deemed appropriate for historical analysis if homoplasy can be excluded (independent convergent evolution). Excluding homoplasy means is taken to indicate that it is reasonable to assume that the tree in question estimates the history of the data and analysis can proceed (cf. \citealt{holland2020accuracy}; \citealt{evans2021uses}). One of the most common approaches to test if data are valid to use for analysis with a particular tree is to test for statistically significant phylogenetic signal. Phylogenetic signal is the ``tendency for related species to resemble each other more than they resemble species drawn at random'' \citep[905]{blomberg2002tempo}. This concept is independent from measurements of conservatism of traits or species/languages. Tests of phylogenetic signal can be carried out for linguistic data as well as biological and cultural data, as we will see in §\ref{sec:is_it_valid}.

One of the drawbacks of conventional approaches to ASR in historical linguistics is that they typically involve a great deal of manual work and, as mentioned earlier, it can be difficult to be completely transparent with all analytical decisions and their contexts. In particular, while there is often agreement on the presence of sound correspondences or cognate sets, there can often be conflicts regarding how to weight information and the plausibility of reconstructions. In contrast, computational phylogenetic methods are a set of tools that can be applied with great speed, and all analysis is explicit and consistent, even over large amounts of data. Computational approaches are not intended to replace traditional historical linguistics, but rather to function as a complement, streamlining and making more transparent parts of the process. In this paper, we compare the two approaches conceptually and examine how often computational methods of ASR arrive at the same conclusions as traditional historical linguistics. I will also investigate what the computational methods say when historical linguists disagree, and make new predictions about the grammar of proto-languages.

%--- with some arguing that this cannot be included in CM at all. Furthermore,  CM produces knowledge about relevant similarity between languages (regular sound correspondences and cognates),  proto-states and subgroupings but crucially \emph{not} branch lengths, inferences about specific migration paths etc. The methods that historical linguists use to derive this information, which is often necessary to make a language tree, is technically outside of CM ``proper''. In this paper, we will not be creating any new trees but use existing ones. However we will use methods that take into account branch lengths and compare reconstructions of abstract grammatical features specifically. The investigation goes beyond what might be called ``The Comparative Method Proper'' and concerns reconstruction in historical linguistics more generally. 

%\footnote{[17-22]{clark1973aspects} is one of the more prominent instances of a historical linguists spelling out the principles underlying reconstruction in historical linguistics more generally, including syntactic reconstruction. However, 
%{walkden_2013}
%} 

The case study used in this paper is the Oceanic subgroup of the Austronesian language family and the grammatical features of four of its proto-languages. I use information about the extant daughter languages from the Grambank dataset \citep{grambank_release} to infer the structure of proto-languages given three trees: (1) Glottolog 4.5 \citep{glottolog4_5}; (2) \citet{grayetal_2009} - Maximum Clade Credibility Tree (MCCT); and (3) \citet{grayetal_2009} - averages over a sample of the posteriors (a random 100 trees out of 4,200, see more in §\ref{the_trees}). 

Findings from the HL literature have been translated into datapoints in the Grambank format for four specific proto-languages: Proto-Oceanic, Proto-Central Pacific,\footnote{The concept of Central Pacific as a coherent subgroup is not uncontroversial. \citet{grace1958position} and \citet{pawley1972internal} made a case for a subgroup consisting of Fijian, Polynesian and Rotuman. Later \citet{geraghty1996} shows that the evidence for this stage is limited. We will be using it here in this study because it occurs enough frequently in the literature, but readers should be aware that it is less likely to have been a genuine coherent language of a community compared to the others. Thank you to Andrew Pawley for drawing this to my attention.} Proto-Polynesian and Proto-Eastern Polynesian. The computational methods take as input the language-level datapoints in the Oceanic subgroups and then infer grammatical states of ancestral nodes in the trees (proto-languages). The structural features of the four proto-languages are extracted for each tree and method and compared to conclusions from traditional historical linguistics. 

The results are evaluated in terms of concordance between each method and the predictions from traditional historical linguistics. We are evaluating how much they agree, not necessarily which one is correct. Which method is the most appropriate should be decided a priori based on the conceptual underpinnings and assumptions of the method and how plausible that model of change is (see more in §\ref{sec:ars:metod:hist}, §\ref{sec:asr_methods} and §\ref{sec:MP_ML_MC}). Both traditional methods of ASR in HL and the particular computational approaches in this paper have advantages and disadvantages. Much of the conceptual infrastructure is similar, and for this reason we would assume a high degree of concurrence between the methods. 

There is one area of Oceanic grammatical reconstruction where there is considerable disagreement. This concerns the nature of the alignment systems of Proto-Polynesian and Proto-Central Pacific. This issue will be investigated and evaluated separately from the overall results of how much agreement there is between traditional HL and computational approaches.

Finally, this study also yields predictions about grammatical features of the four proto-languages that were not addressed by the HL studies surveyed here.

%The tools of computational reconstructions are different from classical historical linguistics, and the data used in this chapter, the Grambank dataset, is different from the source material that historical linguists work with. This is further discussed in section \ref{sec:ars:metod:hist}

\FloatBarrier
\section{Background}
\label{recon_grammar}

\subsection{The methods of Ancestral State Reconstruction in traditional historical linguistics}
\label{sec:ars:metod:hist}
%In order to interpret the differences between the results of the computational approach versus the classical historical linguistics approach, it is first necessary to clarify the different methodologies and their consequences. 
This section lays out the fundamental principles of historical linguistics and how they relate to this paper.

The core method by which historical linguists reconstruct language history generally is known as the ``Comparative Method''. The Comparative Method is based on finding words or morphemes in different languages that have the same (or similar enough) meaning and display non-trivial, systematic phonological correspondences. By investigating these sets of words, it is possible to deduce which are inherited from a common ancestor, i.e., which ones are cognates. For example, \citet{blust2004}, \citet{greenhill2011pollex} and many other scholars have analysed M\={a}ori [maor1246] /toru/ (meaning `three') as deriving from the same word as Hawaiian [hawa1245] /kolu/ (`three'). These two words are thus cognates, and this information can then be used to reconstruct a form for Proto-Polynesian. Furthermore, many words that mean the same/similar thing in M\={a}ori and Hawaiian show this pattern of /t $\sim$ k/ correspondence, e.g., M\={a}ori /mate/ $\sim$ Hawaiian /make/ `to be dead' and M\={a}ori /whitu/ $\sim$ Hawaiian /hiku/ `seven' \citep{ABVD}. There is a systematic correspondence between these two sounds; regularly when there is a /t/ in M\={a}ori, there is a /k/ in the corresponding position in Hawaiian.\footnote{Further research into more Austronesian languages shows that Hawaiian /k/ is more likely to be an innovation and M\={a}ori /t/ a retention from an older proto-language (cf. in the Austronesian language Amis of Taiwan `three' is /tulu/). Therefore, we can reconstruct that the change went from /t/ $\rightarrow$ /k/.} This is known as a ``systematic sound correspondence''. 

One crucial part of this approach is what \citet{walkden_2013} calls the ``Double Cognacy Criterion'' which states that both the part (i.e., the sound) and the context it occurs in (i.e., the word) need to be cognate in order to form valid data for ASR and subgrouping in conventional historical linguistics. In the above example, the sounds /t/ and /k/ are sound correspondences (sound-cognates) of each other, as are the words /toru/ and /kolu/. There is cognacy at two levels, both of the part of the word (the sound) and the word itself.

The Double Cognacy Criterion is often more difficult to apply when reconstructing structural features, which has led some to say that reconstruction of grammar is impossible (cf. \citealt{lightfoot_2002b}) and others to use a different approach which does without Double Cognacy, often labelled ``Syntactic Reconstruction'' \citep[17]{clark1973aspects}.\footnote{Note that the term ``Syntactic Reconstruction'' is used for reconstruction of both morphology and syntax.} This is relevant for the studies in HL that we will be comparing the computational results to (§\ref{sec:POC_lit_review}). In this paper, we will compare methods of ASR in HL literature more broadly and not focus on only ASR in the specific sense of the traditional Comparative Method.

% {ABVD})\footnote{Note that there are two /k/ sounds in Oceanic languages. One stems from Proto-Oceanic *t and the other from POC *k. See more details in blust2004}.}. 


%The Comparative Method provides us with a) sets of words which derive from the same word in an ancestor language (cognates), b) sequences of sound changes from proto-languages to the current observable daughter languages and c) a tree or network structure of the relationships between languages. 
%historical linguistics engage in proposing subgroupings based on shared innovations and developing hypotheses about forms in unobserved proto-languages at the same time. 
Besides finding cognates, traditional historical linguists also propose subgroups of languages as a way of modelling their history (task b in Figure \ref{fig:HL_tasks}). The estimation of historical relationships between languages in traditional HL is mainly/only focused on the structure of the tree (what is subgrouped with what) and not the length of branches between nodes (time). As one anonymous reviewer of this paper noted, branch length estimation is not a goal of the Comparative Method at all. This is important because, as we will see, trees without branch lengths are implausible models of history and are suboptimal for ASR-approaches that take branch lengths into account (e.g. Maximum Liklihood, Stochastic Character Mapping etc). There is some work in traditional historical linguistics to establish branch lengths through relative chronology of changes and archaeological anchor points (e.g., dating of clay tablets, texts, etc.; cf. \citealt{pereltsvaig2015indo_dates}), but this work is mainly restricted to the Indo-European family. Estimating branch lengths need not be the same as precise chronological dating. For newer approaches to ASR, the key is the relative order of events rather than their precise timestamps (contrary to estimating Urheimat, where dates matter more). It is also possible with newer methods to incorporate uncertainty about splits -- for example, by positing many different trees with varying branches and splits that fit within a certain probability scope (e.g., a Bayesian posterior). All this is to say that the future of ASR in HL will most likely need to include some estimation of branch lengths as this allows for more sophisticated methods, and possibly also better incorporation of plausibility from conventional HL-ASR.

The processes of suggesting subgroupings and ASR are done in tandem in HL; they are estimated simultaneously (cf. \citealt[7]{protooceanicvol1}). Subgroups are proposed based on shared innovations. In order to determine what is and what is not an innovation, a certain amount of reconstruction of the proto-language's words and sounds (ASR) is necessary. In order to do ASR, some of the tree structure needs to be approximated. Thankfully, this feedback loop between ASR and subgrouping is primarily a factor in the classical historical linguistics analysis of linguistic matter (sounds and words), and less relevant for linguistic patterns (structural features) which is the topic of this paper.

This is different from analysis in biology and cultural evolution where ASR is typically carried out as a separate next step after a reliable model of history is constructed (cf. \citealt{holland2020accuracy}; \citealt{evans2021uses}). 

% The computational approaches to reconstruction applied in this paper are only concerned with ASR, not subgrouping. We are using existing trees as input, these are not estimated in themselves. 

%This is one of several differences between the computational reconstruction methods and conventional approaches in classical historical linguistics.
%we are only focussing on the reconstruction -- not on the identification of regular sound correspondences, cognates or subgroups. 


%list the reconstruction */gaawari/ for Proto-Polynesian as meaning `weak, feeble'. In some of the daughter languages, words deriving from this Proto-word are listed as meaning `bent', `weak', `soft' and `slack (of man)'. These meanings are judged to be plausible semantic extensions of the proto-meaning such that they can be said to be related ---- to be cognates. 

%\footnote{In order to estimate what semantic shifts are reasonable, linguists can study colexifications in contemporary languages. These are instances of different meanings that are expressed by the same word. In the Database of Cross-Linguistic Colexifications (CLICS), users can explore clusters of colexifications, for example: the concept ``sun'' is more closely linked to ``day (not night)'' than it is linked to ``name'' ) {list2018clics2}.}

Historical linguistics has been primarily concerned with the reconstruction of sounds and words, but there is also work on the reconstruction of grammatical features such as morphemes or word order. \citet[17--22]{clark1973aspects} outlines three general principles for ASR in traditional HL that can be applied to structural data and vocabulary:\footnote{It is also possible to include information on the history of particular regions and cultural factors when conducting linguistic ASR, but this is less often made explicit. In the case of Indo-European, which is the language family that has received the most attention so far in historical linguistics, there are even specific procedures involving particular parts of the tree. For example, \citet[6]{goldstein_2022} describes the ``Anatolian Criterion'' whereby ``Proto-Indo-European ancestry can only be established for cognate sets that include an Anatolian language''. This is because most historical linguists working on Indo-European see Anatolian languages as an early off-shoot branch of proto-Indo-European. In addition, work on the Indo-European language family can also make use of explicit information on ancient languages where we do have textual remains, such as Latin, Sanskrit etc. These kinds of procedures are currently not available for most language families in the world, historical linguists working on Indo-European represent a particularly privileged position informationally in relation to the field at large.}

\begin{enumerate}[label=(\roman*)]
\item the number of changes posited (as few as possible, also known as Maximum Parsimony)
\item the plausibility of the changes posited
\item the plausibility of the reconstructed language as a human language (i.e., the degree to which the reconstructed traits work in harmony with each other)
\end{enumerate}

%As was highlighted earlier, ASR in historical linguistics is part of the overall toolbox of the Comparative Method, and as such is done simultaneously with the other two tasks. In this paper, we will be comparing specifically ASR of historical linguistics to computational approaches to ASR.

%The Comparative Method (CM) is a set of principles that can be applied to a set of languages and data to derive subgroupings and ancestral states  This approach has yielded great results, such as the inference of many language families and proto-languages, and has robust control for avoiding trivial similarities. In addition, historical linguists also apply a similar approach to the historical analysis of structural features such as morphology or syntax (e.g.{harris2008reconstruction} \& {walkden_2013}). Historical analysis of patterns (structural features) is less common and more controversial than the reconstruction of matter (sounds and words), primarily because it is difficult to apply the rigorous criteria whereby something is defined as a cognate to structural features {walkden_2013}. This problem has led some scholars to label the enterprise Syntactic Reconstruction rather than incorporate the exercise as an application of the Comparative method \emph{per se}. In this paper, we will be comparing the reconstructions of patterns made by classical historical linguists to the outcomes of computational approaches to ASR that takes as its input abstract typological features. To make it clear that we are focussing specifically on ASR and not the Comparative Method overall we will use the term ASR throughout the paper.

%\begin{enumerate}[label=(\roman*)]
%\item the number of changes posited
%\item the plausibility of the changes posited
%\item the plausibility of the reconstructed language as a human language (i.e., the degree to which the reconstructed traits work well in harmony with each other)
%\end{enumerate}

The first of these principles (``fewest amount of changes'') is the same as what is known in the wider field of phylogenetics as ``Maximum Parsimony'' (MP; \citealt{felsenstein2004inferring}). The idea is to reconstruct states in proto-languages such that there are as few changes as possible between nodes in the entire tree. \citet[17--22]{clark1973aspects} explains how this works by positing an example of seven languages where there is a majority of one kind of value, X, and fewer of another, Y. Figure~\ref{fig:clark_tree} illustrates this example. If we only examine which feature is the most common, we should reconstruct X at the root of this tree (this is what \citealt{goldstein_2022} calls the ``frequency heuristic''). However, this candidate solution would result in two changes (one each on the two paths from the root and to tips A and B respectively). If we instead reconstruct Y at the root, we would only need one change (between the root and PC-G). The solution where we reconstruct Y at the root results in fewer changes -- it is the most parsimonious -- and is therefore the preferred candidate.
 
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{illustrations/Clark_1977_tree.png}
\caption{{Tree from \citet[19]{clark1973aspects} illustrating Maximum Parsimony}}
\label{fig:clark_tree}
\end{figure}

It is important to note that Maximum Parsimony (MP) does not take into account the length of branches, only the changes between each node of the tree (regardless of how far apart they are). It is of course possible that the true solution is \textit{not} the one with the fewest changes. Maximum Likelihood (ML) and other more recent ASR methods improve upon this by taking branch lengths into account, actively estimating likely asymmetric rates (the rate of change X$\rightarrow$Y can be different from Y$\rightarrow$X) and applying the most likely rate to the inference of unknown ancestral states. ML attempts to find the most likely solution; MP finds the solution with the slowest rate.\footnote{It should be noted that my use here of ``rate of change'' in relation to MP (changes per branch) is not directly comparable to rates of change estimated by other methods, such as ML. MP does not technically estimate a rate of change at all and does not model branches in a meaningful way; it is only concerned with changes between nodes. MP can, however, be said to \textit{assume} the slowest rate of change, given the definition of the rate as ``changes per branch''.}

The next principle of ASR in HL concerns the plausibility of changes: phonological, semantic or grammatical. For example in phonology, many historical linguists posit that /s/ is more likely to become /h/ than it is to become /k/,\footnote{Historical linguists do concede that there are instances of irregular sound change (\citealt{blust1996neogrammarian}; \citealt{campbell1996sound}) and that, while they can often be explained by contact, analogy or avoidance of homophony, they sometimes remain unexplained.} and this information is taken into account when doing ASR. In semantics, in the earlier example from M\={a}ori and Hawai`ian, the words /toru/ and /kolu/ both mean `three', but it is possible for cognates to have less similar meanings. For example, \citet{pawley2005meaning} reconstructs the form *panua as meaning `land' or `inhabited territory' for Proto-Oceanic. In various daughter languages, this has changed to `place', `community', `village', `house', `people', `world' and `weather'. The meanings are related to each other, but not identical as in the `three' $\sim$ `three' example earlier. Historical linguists aim to find plausible semantic connections between words that are proposed to stem from the same proto-form. The sound correspondences can be guiding here. If two forms have somewhat different meanings but convincing sound correspondences, then they may still be cognates. This process can be difficult, as \citet[229]{anttila1989historical} explains: ``there are no exact rules for handling semantic change; the final factor here is necessarily the common sense and the experience of the individual scholar.''  

The plausibility of changes also comes into play when reconstructing structural traits. For example, a language going from having no marked dual number on nouns to having a trial number category would be taken as unusual by most linguists \citep[cf.][8]{kikusawa_2006_pro_number} -- it seems like the language has skipped over a necessary step, jumping from `many' directly to `three' without first encoding a `two' category. Grammaticalisation theories have given rise to a number of these plausible historical changes \citep[594--595, 598]{heine2003grammaticalization}.

Lastly, ASR in historical linguistics deals with the plausibility of the whole of the reconstructed proto-language as a system \citep[1]{clark1973aspects}. If we reconstruct a language with very uncommon combinations of features we should be wary and probably question the analysis. For example, it is rare to find a language that has a gender distinction in the first person, but not in the third (though not impossible; cf. \citealt{wals-44}). Likewise, if something is rare in the languages that exist today, we would expect it to be relatively rare also in past languages. This is more relevant for phonology and linguistic structures where we have more worked-out theories of plausible combinations than in the lexicon. This principle has parallels in biology as well, where researchers avoid impossible ancestral states (cf. \citealt{schulmeister2004comparative}).

The procedure of ASR in historical linguistics that has been outlined in this section can and has been applied successfully to sounds and words (be they lexical or grammatical words). The application of this approach to abstract structural features is more controversial and is not always included under stricter applications of the term ``Comparative Method'' per se. For this reason, we will refer to ``traditional historical linguistics ASR'' rather than the ``Comparative Method'' in relation to bodies of work that concern the reconstruction of the grammar of proto-languages (see §\ref{sec:POC_lit_review}).\footnote{It is notable that most of the discussion regarding whether structural ASR is possible has been in relation to Indo-European languages (cf. \citealt{walkden_2013}). This paper offers a view from the Pacific Ocean, where the waves of the debate are more peaceful.}

%See more in section \ref{sec:is_it_valid}.

%. We cannot compare Parsimony cost directly to rate of change estimated by other models, but out of all the possible solutions Maximum Likelihood generates it does not necessarily select the one with the slowest rate of change  (more on this in section \ref{sec:asr_methods}).


%harris2008reconstruction


%As a consequence of that, it can be said that not all reconstruction in historical linguistics is based on the Comparative Method in a strict sense.. Some of the work on reconstruction in historical linguistics cited in this paper can be said to represent \emph{traditional approaches}, but perhaps not necessarily the \emph{Comparative Method} in a strict sense.

%{\color{red}This section and section \ref{diff_lexi_str} are being re-written to more clearly tease out and discuss details of reconstruction of abstract structural features.}

%The plausibility of the reconstruction language to be a human language relies on knowledge about which traits are likely to go together, and which would represent a combination that is veyr implausible. For example, if a language has a dual number category for nouns, i.e., signalling that the number of items is 2, it is likely to also have general plural number. If a reconstruction produces a language with a dual but not a plural, this is cause for concern as this is very unlikely according to linguists. The same is true of the plausibility of the changes from state to state themselves, some changes are assumed to be more frequent and common than others. However, linguists rarely spell out all of these assumptions explicitly in historical reconstruction, which makes it hard to evaluate what is happening. It also makes it difficult to incorporate these concepts in computational reconstruction. 

%Integral to the reconstruction of forms in historical linguistics is \textbf{Maximum Parsimony}. Maximum Parsimony is a method of reconstruction ancestral states (in this case grammatical features of proto-languages) in such a way that there is as few changes as possible from the root to every tip (language). 

\FloatBarrier
\subsubsection{Disagreements in historical linguistics}
\label{sec:hl_disagreements}
As discussed, ASR in historical linguistics involves judgements of plausibility. This requires some assumptions about what features plausibly co-occur in language, and which pathways of language change are more plausible than others. 

Plausibility is important for ASR, both in linguistics, studies of cultural change, and biology. However, this principle is sensitive to differing assumptions and theories. Besides debates over precise subgroupings, many arguments in historical linguistics boil down to disagreements about the plausibility of combinations of traits or of changes. This is also true of the different reconstructions of the alignment system of Proto-Polynesian.

\citet{clark1973aspects} disagrees with \citet{hale_1968}, \citet{hohepa_1969}, and \citet{chung1978} on the case-marking systems of Proto-Polynesian on grounds of plausibility. \citeauthor{chung1978}, \citeauthor{hale_1968} and \citeauthor{hohepa_1969} argue for a reconstruction that is technically less parsimonious on most trees of the languages (i.e., involves more changes), but which they say is more plausible. They posit that Proto-Polynesian had a nominative-accusative case marking system.\footnote{\citeauthor{hale_1968}, \citeauthor{hohepa_1969} and \citeauthor{chung1978} actually suggest three different theories which differ in specific details. For a summary of the differences between the proposals, see \citet[247--249]{chung1978}.} If this was the case, that would mean positing more changes along the tree than if we assumed, as \citet{clark1973aspects} does, that the Proto-Polynesian language was ergative-absolutive. This is due to S\={a}moan and Tongan both having ergative-absolutive marking and both splitting off early (in most accounts of the Polynesian tree) from Proto-Polynesian. Figure \ref{poly_GB409_tree} shows the Polynesian tree with Grambank feature GB409 values marked out.\footnote{Grambank feature GB409 asks if \textit{any} ergative flagging is present. In some instances, the system is not wholly or primarily ergative, but ergative marking is present. It is possible that the scholars involved in the debate would not classify such languages as ``ergative-absolute'' languages \textit{per se}.}

\begin{figure}[p]
\centering
\includegraphics[width=16cm]{illustrations/plots_from_R//tree_plots/poly_tree_example.png}
\caption{{The Polynesian languages in the \citet{grayetal_2009} Maximum Clade Credibility Tree, with the coding of Grambank feature GB409 ``Is there any ergative alignment of flagging?'' marked out. Purple = Yes; Green = No; absence of dot = Not enough information/not clear}}
\label{poly_GB409_tree}
\end{figure} 

I have summarised \citeauthor{chung1978}'s critique of \citeauthor{clark1973aspects}'s proposal into three main points:
 
\begin{enumerate}[label=(\alph*)]
\item the tree used is not an accurate representation of the language history (there was more interaction between S\={a}moan and Tongan after splitting, and these interactions explain the situation)
\item it is possible that the proto-language contained variation and was undergoing change that was only fully realised in some of the daughters
\item the morpho-syntactical changes themselves are less plausible
\end{enumerate}

In a review of \citet{clark1973aspects}, \citet[539]{chung1977aspects} writes:

\begin{quotation}
\noindent Such an approach [as \citeauthor{clark1973aspects}'s] relies on the assumption that the subgroups have developed quite independently once they split off from Proto-Polynesian, so that features shared by both must be attributed to the Proto-language. But in fact, both parts of this assumption are too strong. It is well known that the two primary subgroups of Polynesian did not develop totally separately; there was long-standing contact in pre-European times between speakers of Tongic and some Samoic-Outlier languages, as Clark himself notes (p. 27). Further, and more generally, it is simply not true that \textit{every} feature shared by related languages must have existed in the Proto-language uniting them. Languages are constantly undergoing change; it is reasonable to suppose that Proto-languages were no different from real languages in this respect. But if this is so, then it is also reasonable that changes begun in a Proto-language may have continued even after its separation into daughter languages. In this way, related languages may come to share a feature that existed only in embryonic form, or not at all, in their common ancestor.
\end{quotation}

This debate contains more twists and turns. In our analysis, we will be using trees that represent the history of the languages in a similar way to \citet{clark1973aspects}, which means the results are sensitive to the same critique by \citet{chung1977aspects} (i.e., not taking into account contact between S\={a}moan and Tongan). We are also not able to use plausibility in our computational reconstructions since we do not have access to formalised data on what plausible language profiles or changes are. This is a key difference between computational reconstruction and traditional approaches to reconstruction.

%It is possible that with the added information on rates of change and branch length that comes with the Maximum Likelihood approach we are able to approximate some parts of historical linguists' knowledge of plausibility. In that case, we would expect the Maximum Likelihood results to concur more with the predictions by expert linguists. If historical linguists mainly do operate on the same principles of Maximum Parsimony, and/or Maximum Likelihood is not able to approximate plausibility, we would expect the results of Maximum Parsimony to concur more with findings in traditional historical linguistics.


In this study, any instances of conflicting data from historical linguists concerning proto-languages are evaluated separately from the overall results and will be reported in a separate section (§\ref{sec:conflicts}). There are three instances of this: two features related to the alignment of Proto-Polynesian (GB408 ``Is there any accusative alignment of flagging?'' and GB409 ``Is there any ergative alignment of flagging?'') and one feature for Proto-Central Pacific, where \citet{kikusawa2002proto} and \citet{ball2007ergativity} disagree on the alignment as well.

%can fall short of reconstructions carried out by classical historical linguists because they are able to take these plausibility considerations into account.

%\subsubsection{Reconstruction and subgrouping in tandem}
%The processes of subgrouping and reconstruction are done in tandem in historical linguistics; they are estimated simultaneously. Subgroups are proposed based on shared innovations. In order to determine what is and what is not an innovation, a certain amount of reconstruction is necessary. In order to make reconstructions, some of the tree structure needs to be approximated. Pawley (personal correspondence) notes that most of the subgrouping done in historical linguistics tends to be at the lower level. 
%This can be seen later in this paper in the difference between the Glottolog tree (Figure \ref{tree_coverage_oceanic_glottolog}), which is based on classical historical linguistics,  and the Gray et al 2009-tree (Figure \ref{tree_coverage_oceanic_gray}), which is inferred with Bayesian phylogenetic methods using basic vocabulary data. Most of the splits in the Glottolog tree occur close to the tips, whereas the splits are more spread out over the distance between the root and the tips in the Gray et al 2009-tree.

%Besides parsimony and plausibility, it is also important to know how to weight evidence when conducting historical linguistics research, in particular when it comes to subgrouping. This is less often discussed explicitly, but it is related to issues of plausibility and is likewise a source of disagreement. It is for example possible that certain datapoints are more susceptible to contact-induced change than others, and should therefore carry less weight if we are trying to infer a family tree. This is why items and features that are thought to be particularly stable and unlikely to be borrowed are used in reconstruction and subgrouping [cf.][]{pawley_2009_solomons}.

%In this paper we are not proposing any new subgroupings, so the problem of weighting evidence is not present in this manner. For the reconstruction of grammatical features, all languages are weighted as equally valuable and we use the tree topologies directly to control for non-independence of datapoints as opposed to careful sampling \[cf.][]{ross2004morphosyntactic}.
%We are reconstructing grammatical features and this is another area where weighting can be relevant. All languages are weighted the same for the reconstruction, but 

%As was discussed in \ref{sec:dep}, not all datapoints are independent of each other and this may be one reason to weight them differently. 

%For example, {wilson_whence} presents a case for Eastern Polynesia (EP) being settled from the so-called ``Northern Outliers'' (i.e., Polynesian languages of Micronesia and the Solomons) by demonstrating shared innovations of lexicon and grammar to the exclusion of Samoa, Pukapuka and Tokelau (which were closer to EP in previous proposals). The paper lays out 73 innovations in support for this theory, and states that there is a lack of shared innovations supporting grouping Eastern Polynesia and the Samoic group together, as had been previously suggested by {pawley1966polynesian}. {wilson_whence} proposes that a more accurate reflection of this data are to group Eastern Polynesian with the Northern Outliers. On the other hand, [53, 61]{pawley1966polynesian} presents two cases where Samoan and some of the Northern outliers shared features to the exclusion of Eastern Polynesia (sing/plural distinctions in indefinite articles and the form of the human number prefix). Besides the sheer number of datapoints, it is clear that historical linguists also weight different pieces of information differently. Without an internalised in-depth knowledge of these matters, it is difficult to know how to evaluate the support for these conflicting theories of the origins of Eastern Polynesian communities. Is it as significant that the Northern Outliers and Eastern Polynesian languages shared a word for a certain kind of fish (\emph{*kamakama}) as the fact that they have also, as a group, added an \emph{o-} to the Proto-Polynesian root \emph{*fia} (want) {wilson_whence}? 

%In this paper we are not proposing any new subgroupings, so the problem of weighting evidence is not present in this manner. We are, however, reconstructing grammatical features and this is another area where weighting can be relevant. All languages are weighted the same for the reconstruction, but 

%The tree structure and the method (Maximum Parsimony or Maximum Likelihood) determines the reconstruction. This can be compared to weighting evidence from oversampled areas/subgroups less when reconstructing. 

% \[135]{marck2000} also presents the case that the Northern Outliers are most closely related to Tuvaluan.

%It is clear that considerable experience and meticulous considerations are needed in order to make these judgements and interpret the results of these papers appropriately. This entails long periods of training and familiarisation with the method in practice and the particular languages in question. [721-731]{blust2013austronesian} suggests that we should bring in non-linguistic evidence to bear on these theories as well. How would a settlement from the Northern Outliers be achieved materially? By finding supporting or conflicting evidence from other disciplines, we can make more robust predictions 

%For full disclosure, both of the trees used in this study (Glottolog 4.5 and {grayetal_2009}) group EP closer to the Northern Outliers than to Samoan, and it is becoming more accepted. 


%Each of these tasks can be accomplished by different approaches. For example, historical linguists have certain criteria regarding what qualifies as relevant units to compare over (task a) and what ends up underlying the construction of the history (task b). In contrast, biologists use many different kinds of methods for Ancestral State Reconstruction: Maximum Likelihood, Stochastic Character Mapping etc (cf. {joy2016ancestral}), not to mention the variation in tree-constructing methodology. 

\FloatBarrier
\subsection{Evaluating if the data are valid for phylogenetic analysis: the Double Cognacy Criterion and phylogenetic signal}
\label{sec:is_it_valid}

There is considerable debate within historical linguistics regarding whether patterns (grammar) can indeed be analysed with the Comparative Method at all. One of the primary sources of disagreement is the criteria whereby similarities are judged to be valid for historical study. The Comparative Method is built on the recognition of the importance of cognates and sound correspondences -- two concepts that are difficult to translate into the world of morphology and syntax (see for example \citealt{harris2008reconstruction}; \citealt{walkden_2013}). In order to establish shared inheritance, two languages need to exhibit pairs of words where the words themselves can with great certainty be said to be related and where there is also a correspondence between the sounds \textit{within} the words. This is what \citet{walkden_2013} calls the ``Double Cognacy Condition''. What does this mean for grammar? Are morphological patterns within sentences similar to sounds within words? The answer is not clear and most likely varies depending on what kind of structural data we are dealing with (word order vs organisation of pronoun paradigms vs presence of certain markers, etc.). For this study, we will not delve too far into this debate but instead use a quantitative test of phylogenetic signal to estimate if the data are suitable for ASR.

%For the four proto-languages and structural traits considered here, 118 datapoints are described in the classical historical linguistics literature (see \ref{sec:POC_lit_review}). In contrast, the computational approaches derived an additional 686 predictions about structural features of long-gone languages. 

We take a leaf out of the books of cultural evolution and biology in terms of evaluating if the data are appropriate for phylogenetic analysis. In these fields, the three tasks outlined earlier are separated out; appropriate data for analysis are collected (this can differ for tree/network construction and ASR) and trees\footnote{History of organisms and culture can be understood as trees, waves and networks. For the sake of space, we will write ``tree'' since this is most common, but waves and networks are not excluded \textit{a priori}.} are constructed (usually with carefully chosen model approaches and priors). Once a reliable tree exists, ASR is carried out as a separate next step (cf. \citealt{holland2020accuracy}; \citealt{evans2021uses}). There is a veritable smörgåsbord of methods that a scientist can choose to apply to each task. For example,  a plain distances-based approach to making a tree can be used \citep{jager2016inferring} or more sophisticated Bayesian tools like BEAST \citep{drummond2015bayesian}. Similarly, for ASR there are different approaches with different pros and cons (see \citealt{joy2016ancestral} for an overview). 

The input data for ASR can differ from what was originally underlying the construction of the tree. If we believe that the tree is likely to be a good estimation of the history in view of other data besides what it was directly based on, we may be able to carry out analysis with that tree on different data. For example, \citet{watts2016ritual} analyse evolutionary dynamics of societal variables such as ritual human sacrifice and social stratification in the Pacific using trees that are based on basic vocabulary and archaeological priors of island settlement \citep{grayetal_2009}. Besides arguing that it is reasonable to assume that the history of a community's sociopolitical past is similar to its linguistic past, it is also possible to test the strength of the phylogenetic signal statistically and use this as a guide. If the data have a reasonable phylogenetic signal, we assume that it is likely that the data were generated by the tree and that we can proceed with further analysis. This is what \citet{watts2016ritual} do for their data, and they find that it is possible to carry out the analysis. This can also be done for our Oceanic trees and structural data.

Phylogenetic signal is the degree to which it can be assumed that a particular tree is likely to have given rise to the data in question: the tendency of related tips to resemble each other more for a particular variable than they would if randomly re-arranged \citep[905]{blomberg2002tempo}.\footnote{\textit{Nota bene}: this is \textit{not} the same as stability/conservatism; phylogenetic signal is a separate concept.} There exist several different tests of phylogenetic signal: \citet{pagel1999inferring}'s $\lambda$, \citet{blomberg2003testing}'s K, \citet{borges2019measuring}'s $\delta$ and \citet{ives2010phylogenetic}'s $\alpha$, among others. In this study, we will use a common and conceptually simple measure: \citet{fritz2010selectivity}'s D-estimation. This metric has been used in language studies on sounds \citep{macklin2021phylogenetic} and grammatical features \citep{hubler2022phylogenetic} and is relatively straightforward. The D-algorithm takes a tree and a binary trait (in this case structural linguistic features) and simulates what the distribution of values would be if the data were: (a) generated by Brownian evolution, or (b) randomly generated. Both scenarios are simulated with the same prevalence of tip states as the real data. The algorithm produces a D-estimate for each trait and tree, which represents the similarity to these two scenarios. If this value is close to 1, the data are similar to what they would be if they were randomly generated (if the D-metric is higher than 1, this represents it being over-dispersed\footnote{Over-dispersed here means that the trait is spread out over the tips in a way that shows no clusters, even less clustered than one might expect by chance. For example, sister-pairs may have opposite values to each other all throughout the tree. See Table 1 in Fritz and Purvis (\citeyear[1044]{fritz2010selectivity}) for illustrative figures.}) and if it is near 0 then it is more similar to Brownian evolution. The algorithm also produces kinds of p-values which show how likely it is that the data are dissimilar from 0 (Brownian) and 1 (random).

In this study, we are primarily concerned with 84 unique Grambank features\footnote{Sometimes we are interested in the same feature for more than one proto-language. The total amount of datapoints we are interested in for comparison to conventional historical linguistics is 115 over four proto-languages, which reduces to 84 specific unique features.} and three trees: (1) Glottolog 4.5 \citep{glottolog4_5}; (2) \citet{grayetal_2009}'s Maximum Clade Credibility Tree (MCCT); and (3) an aggregate of 100 random trees in the \citet{grayetal_2009} posterior. We carry out the D-estimate analysis on all of these features over all trees using the function \texttt{phylo.d} in the R package \texttt{caper} \citep{orme2013caper}. The results are summarised in Table \ref{d_estimate_summary}. The second column of the table shows the mean D-estimate value over all 84 relevant Grambank features for each phylogeny. The third column shows the percentage of features with p-values that indicate whether they are Brownian or clumped (pval0 > 0.05). The fourth column shows the number of features for which it is not possible to carry out the D-estimate calculation because they do not meet the rigours of the model. In all of these cases, it is because there is a very skewed distribution of values over the tips (e.g., 4 tips with ``absence'' and 118 with ``presence''\footnote{It does not matter here whether it is the presence or absence of a trait that is rare; this has no effect on the measurement of phylogenetic signal.}) and this is not suitable for the analysis (for more technical details see Supplementary Material \ref{supp:d_estimate}). We can consider all of these to be a kind of ``super-conservative'' feature (i.e., one which rarely evolves), but we cannot derive a measurement of phylogenetic signal per se. Lastly, some features are excluded because there is too much missing data which causes the pruned trees to have too few tips for analysis.

\input{"illustrations/plots_from_R//D-estimate_summary.tex"}

Most features under study have a D-estimate close to 0, meaning that they have phylogenetic signal. There are, however, many features that are not close to a D-estimate of 0. The results (§\ref{results}) and conclusions  (§\ref{conclusions}) further discuss the relationship between this principle and agreement with conventional HL.

\subsection{Computational phylogenetic methods}
\label{sec:asr_methods}
%This section outlines the computational methods of ASR which will be used in this study, and contrasted with the conventional approaches in historical lingusitics outlined in section \ref{sec:ars:metod:hist}.
In recent years, linguists have begun to apply computational phylogenetic methods from biology to the reconstruction of linguistic history. Biologists have, similarly to linguists, been interested in inferring trees of the genetic relationships between species,\footnote{Interestingly, the use of trees in linguistics and biology first occurred in publications just one year apart with \citet{schlegel1808sprache} publishing a tree of languages and \citet{lamarck1809philosophie} a tree of species. However, as \citet[370]{greenhill2015evolution} notes, it was not until \citeauthor{darwin1859origin}'s publication of \textit{The Origin of Species} in \citeyear{darwin1859origin} that the concept of species trees in biology truly took off.} ancestral states and the tempo and mode of evolution \citep{atkinson2005curious}. Biologists and linguists may have inspired each other, but methodologically the fields progressed separately for a long time \citep[370]{greenhill2015evolution}. Both fields are interested in answering similar questions: How are these languages/species related?; What was the earlier state of a language/species?; Which traits are changing slower/faster?; etc. The two fields have developed different methodologies, with biologists leaning more towards quantitative computational methods for tree construction and ASR compared to linguists who have focussed more on rigourous tests for which linguistic data are valid for analysis (see for example the Double Cognacy Criteria in \citealt{walkden_2013}). It is possible that this is due to the material under study; it may be more difficult to tease out non-trivial similarities in languages than in species (especially since genome sequencing has become more readily available).

% \section{Computational methods}

Applying computational methods of ASR to linguistic data is becoming more common. J\"ager and List (\citeyear{jager2018using}) apply three different methods (MP, ML and Minimal Lateral Networks) to cognate class reconstruction in three different language families (Chinese, Austronesian and Indo-European) . The aim of that study is primarily to evaluate how often the methods reconstruct the same state as what the authors label ``the Gold Standard'' (reconstructions by traditional historical linguists using the classical Comparative Method). This is similar to the study at hand; one of the aims of this paper is to estimate the degree of concurrence between computational methods using typological database data and conventional approaches in HL. The data that serve as input to the computational machinery in J\"ager and List (\citeyear{jager2018using}) are annotated ``by hand'' for cognacy by historical linguists, meaning that the identification of cognate classes is still an entirely human affair (task a in Figure \ref{fig:HL_tasks}). This is also true for this study -- the identification of structural features in languages is a human process. The overall result of J\"ager and List (\citeyear{jager2018using}) was that ML performed the most similarly to traditional HL ASR, but that there were still several shortcomings. Most notable of these were undetected borrowings, variation within languages and parallel independent shifts. In this paper, we address the potential for contact events by using sets of trees from a Bayesian posterior (as J\"ager and List (\citeyear{jager2018using}) also do), some of which may represent an alternative contact history (see §\ref{the_trees}).

There are also two recent studies of Indo-European grammatical history: Carling and Cathcart (\citeyear{carling2021reconstructing}) and \citet{goldstein_2022}. Carling and Cathcart (\citeyear{carling2021reconstructing}) evaluate different theories of the history of the morphosyntax of Indo-European by comparing these to the product of computational Bayesian phylogenetic modelling. They find support for the ``canonical'' model of Indo-European syntax. Goldstein in his paper challenges a commonly applied principle in the reconstruction of Indo-European syntax: the ``frequency heuristic'' which holds that ``if the number of homologous elements (e.g., lexical cognates) in the daughter languages meets a minimum threshold (canonically three), their ancestor is reconstructed to the root of the tree'' \citep[3]{goldstein_2022}. This is done because scholars argue that the true tree is unknown and that this is an appropriate method in the absence of the true tree. \citeauthor{goldstein_2022} argues that the appropriate action is instead to carry out reconstruction on many different trees that represent different possible histories -- a Bayesian posterior tree sample. He argues that this is methodologically more sound and because the results of his specific case-study are in accordance with the consensus in HL it strengthens their validity.

Both Carling and Cathcart (\citeyear{carling2021reconstructing}) and \citet{goldstein_2022} use a Bayesian method of ASR within the Continuous-Time Markov Chain (CTMC) framework.\footnote{The main difference between the methods of Carling and Cathcart (\citeyear{carling2021reconstructing}) and \citet{goldstein_2022} is that Carling and Cathcart (\citeyear{carling2021reconstructing}) use a tree structure informed by \citet{chang2015ancestry} and comparative-historical \textit{communis opinio} and vary the branch lengths 10,000 times in a principled and informed manner to generate 10,000 different trees, while \citet{goldstein_2022} takes 100 random samples directly from the posterior of \citet{chang2015ancestry}.} This approach comes with certain important assumptions, to quote from \citet[77]{goldstein_2022}:

\begin{quotation}
CTMCs model language change as a stochastic phenomenon with rate parameters that govern the amount of time between transition events. It is worth highlighting the assumptions that these models bring with them. First, character states at the nodes of a tree are assumed to depend only on the state of their immediate ancestors and the length of the branch along which they evolved \citep[4]{Cathcart_2018}. Second, the probability of a transition depends only on the current state of a language. Its previous history is irrelevant. This is known as the \textsc{markov property} [emphasis in original]. Finally, rates of gain and loss are assumed not to vary across the tree.
\end{quotation}

It is always important to be explicit about the assumptions an approach takes and evaluate if they make sense for the given situation. For linguistic data, these assumptions do seem to hold. For more details on the methods, see \citet{goldstein_2022}, \citet{pagel2004bayesian}, \citet{ronquist2004bayesian} and \citet{liggett2010continuous}. 

Another popular method of ASR is ``Stochastic Character Mapping'' (SCM; \citealt{huelsenbeck2003stochastic}). SCM is a procedure that simulates character histories using Continuous-Time Markov rates. These rates are usually estimated on the basis of the tree topology and the data attested at tree tips before SCM is carried out but can also be defined in other ways. SCM can follow the same CTMC approach employed by Carling and Cathcart (\citeyear{carling2021reconstructing}) and \citet{goldstein_2022}, but not necessarily.\footnote{Thank you to one of the anonymous reviewers of \textit{Diachronica} for highlighting this.}

%reviewer 2: This statement is imprecise. SCM is a procedure that simulates character histories using CTM rates. These rates are usually estimated on the basis of the tree topology and the data attested at tree tips before SCM is carried out. So SCM is a procedure that can follow the method described by Goldstein (but can also be used with arbitrarily defined rates).

Computational approaches to reconstruction not only allow us to streamline the process by inferring the prior states of hundreds of traits in a short span of time, but they also allow us to apply exactly the same principles in exactly the same way to all pieces of data. This is much harder to do manually since different scholars may use slightly different assumptions and judgements when conducting ASR. One could say that what we lose in deep human insight, we gain in consistency and speed. Furthermore, if the deep human insight of historical linguistics could be quantified into priors that can be fed into computational models, we may not need to lose anything. Unfortunately, this is not the case currently, but it may be possible in the future.
%Any assumptions about plausibility of changes or states needs to be explicitly included into the model, and applied identically across the sample.


\FloatBarrier
\section{Materials and methods}
\subsection{Methods: Maximum Parsimony, Maximum Likelihood and Most Common}
\label{sec:MP_ML_MC}
In this study, we will be reconstructing the presence or absence of structural features in proto-languages of the Oceanic subgroup using three methods: Maximum Parsimony, Maximum Likelihood and Most Common. This section gives a brief overview of the three methods. Further technical details concerning their precise application can be found in Supplementary Material \ref{supp:tech_details}. For an extensive comparison of different methods of ASR and their advantages, see \citet{joy2016ancestral}.

Maximum Parsimony (MP) finds the set of ancestral states that results in the fewest number of changes between nodes (also known as ``lowest Parsimony cost''). If we think of the rate of change as the number of changes in the tree, then MP selects the candidate solution with the slowest rate out of all possible solutions it can choose from. MP is intuitively simple.\footnote{While the principle of MP is practised in traditional ASR in historical linguistics, it should be noted that they rarely use the term \textit{per se}, but rather the description of ``fewest number of changes along the tree''.}

MP can be critiqued on the basis that it does not take into account branch lengths in the tree (the time between splitting events). Furthermore, MP necessarily assumes that the solution that posits the fewest changes (slowest possible rate of change) is also the most probable one. This is not necessarily a valid assumption; some features may evolve at a faster rate than MP predicts. Both of these disadvantages are addressed in the second method we will be applying: Maximum Likelihood (ML).

%The second method which will be applied in this study is that of \textbf{Maximum Likelihood}. 
%\subsection{Maximum Likelihood}
ASR using ML posits the most likely ancestral state distributions based on the overall probabilities given all the nodes in the tree and all branches. This approach does not assume that the slowest rate of change is the most probable one. If, for example, the distribution of values at the tips is very scattered, with sibling pairs frequently having different values, ML will infer that the feature has a high rate of change and use that information when positing ancestral states as well. The ML algorithm assigns probabilities of state changes and distributions based on branch lengths. A mutation along a shorter branch is given more weight in the likelihood calculations than if it had occurred along a longer branch. Furthermore, reconstruction using ML allows us to use a model of change where we do not assume that the rates for losses (1$\rightarrow$0) are equal to the rate of gains (0$\rightarrow$1). In this study, we use an ``All Rates are Different" (ARD) model, which allows for the rate of loss and gain to be different.\footnote{Similarly to the studies by Carling and Cathcart (\citeyear{carling2021reconstructing}) and \citet{goldstein_2022}, rates cannot vary within the tree in this study.}\textsuperscript{,}\footnote{It is possible to further specify the model, for example by specifying transition rates, specify certain nodes beforehand, etc. For this study, this was not done since there is no information to base these decisions on.} Specifically, we are also using a marginal ML estimation -- for more details see Supplementary Material \ref{supp:tech_details}.

It is impossible for MP to take into account branch lengths, nor can it assume anything but the slowest rate of change or posit different rates for losses and gains. It is, however, possible for historical linguists to estimate something similar by taking into account the length of time and the ``plausibility of the changes posited'', including whether losing a certain feature is more likely than gaining it. In this study, we compare MP and ML reconstructions with conventional ASR in HL. If the results from conventional ASR are more similar to that of ML, a potential explanation would be that the ``plausibility of changes posited'' is indeed operating along similar lines as ML by taking branch length into account and assuming varying rates of change.

%\subsection{Methods: Most Common}
We will also compare the predictions of historical linguists with a ``dummy-model'' which is based solely on which value is the Most Common (MC) in the daughter languages of a given proto-language, entirely disregarding the tree structure.\footnote{This is similar to the ``frequency heuristic'' described in \citet{goldstein_2022}.} In the toy example in Figure \ref{fig:clark_tree}, this approach would reconstruct that the root had feature value ``X''. Whether we prefer MP, ML or another approach to reconstruction, actually taking the tree structure into account is generally sounder methodology. %We expect that both methods has a higher degree of concordance with the findings in historical linguistics compared to only counting which value is most common.

All analyses have been calculated in \texttt{R} \citep{R} using the packages \texttt{castor} (MP; \citet{louca2017efficient}), \texttt{phangorn} (MP; \citealt{phangorn}) and \texttt{corHMM} (ML; \citealt{R-corHMM}). The packages \texttt{ape} \citep{paradis2004ape}, \texttt{adephylo} \citep{jombart2017package}, \texttt{phytools} \citep{revell2012phytools}, \texttt{psych} \citep{psych_r_package},  \texttt{reshape2} \citep{wickham2020reshape2} and \texttt{tidyverse} \citep{tidyverse13} were also used for data wrangling, analysis, summarising and visualising.\footnote{For a complete record of all R-packages used, see Supplementary Material \ref{supp:r_packages}.}

All of the R code and data necessary for the analysis in this paper is published alongside the paper, in Supplementary Materials and in archived web-storage (Zenodo).

\url{https://doi.org/10.5281/zenodo.8056616}

\url{https://github.com/HedvigS/Oceanic_computational_ASR/releases/tag/v0.1}

 \FloatBarrier
\subsection{Calculation of similarity between predictions from conventional HL and computational approaches}
\label{result_calc_section}
We calculate the similarity of the predictions of historical linguists and computational methods with a measure of concordance.\footnote{This metric is also known as \textit{accuracy} in machine learning, but we do not use that term because we wish to avoid the connotation that what is being measured is the real-world accuracy of the reconstruction as opposed to the agreement between methods.} Concordance measures how closely the computational reconstruction matches historical linguists' reconstruction -- how much they concur. It is measured as the number of agreements about grammatical features (i.e., Grambank binary questions) of predicted proto-languages, divided by the total number of grammatical features predicted. 

%In addition to these two scores we will also calculate how much better each method does compared to just counting which is the most common vale of a feature in the daughter languages. As we learned in section \ref{sec:ars:metod:hist}, simply relying on frequency and not taking the tree structure into account can lead us astray. Whether we prefer Maximum Parsimony, Maximum Likelihood or another approach to reconstruction it should be the case that actually taking the tree structure into account is the more sound methodology. We expect that both methods has a higher degree of concordance with the findings in historical linguistics compared to only counting which value is most common.

For each feature, the methods predict a distribution of the two states (presence and absence) for every ancestral node. If the distribution is (qualified) majority presence (i.e., more than 60\% of the ancestral state is ``1''), it is registered in the results as ``Presence''. If the distribution is less than 40\% presence, it is registered as ``Absence''. If the ancestral state is between 40--60\% of either state, the prediction is registered as ``Half/Half''. This is done to highlight the amount of uncertainty the results sometimes contain, while at the same time making it a fair comparison between MP and ML. Comparing the raw distributions themselves is not a fair comparison because MP is always more likely to suggest 0, 0.5 or 1 results (because the majority of the splits in the tree are binary), whereas ML rarely produces exactly 0 or 1. 

Rounding into these bins (``Presence'', ``Absence'' and ``Half/Half'') also makes it possible to derive the number of ``True Negatives'', ``True Positives'', etc., which allows for the calculation of concurrence scores. If the reconstruction of a feature by HL experts for an ancestral node is ``Presence'' and the algorithm predicts presence with over 60\%, it is counted as a ``True Positive'', and so on.\footnote{The terms ``True'' and ``False'' are used here in accordance with terminology in machine learning. In this instance, they are indicating whether the results from the computational method and historical linguists agree (True) or not (False). It should not be interpreted as a measure of empirical ``Truth'' necessarily.} Table~\ref{example_HL_prediction_table_true_positives} illustrates how the results are summarised.

\begin{table}[ht]
\centering
\caption{Table illustrating how the results of ancestral node predictions are calculated}
\label{example_HL_prediction_table_true_positives}
\begin{tabular}{|p{3cm}|p{5cm}|p{5.5cm}|l|l|l|l|l|}
\hline
\textbf{Finding by Conventional Methods} & \textbf{Prediction by Computational Method} & \textbf{Result} \\ \hline
Absence & >60\% Absence & True Negative \\ \hline
Absence & >60\% Presence & False Positive (type 1-error) \\ \hline
Presence & >60\% Presence & True Positive \\ \hline
Presence & >60\% Absence & False Negative (type 2-error) \\ \hline
Absence & 40--60\% Presence/Absence & Half \\ \hline
Presence & 40--60\% Presence/Absence & Half\\ \hline
\end{tabular}
\end{table}

For each method, a plain concordance score (Equation \eqref{eq:accuracy}) is then calculated. The score is calculated between all computational methods and the conventional historical linguists' prediction, as well as between all computational methods themselves.\footnote{When comparing one computational method result to another, ``Half/Half'' -- ``Half/Half'' count as a True pair. Otherwise the scoring is the same.}

\begin{equation}\label{eq:accuracy}
\frac{\text{True Negative + True Positive}}{\text{True Negative + True Positive + False Negative + False Positive}}
\end{equation}

It is also important to take into account the ``Half/Half'' results. This count represents instances where the method was not able to say with strong confidence that something was present or absent. The reason it is interesting to separate these out is that, while they may indicate a majority result in one direction, it is not far from suggesting the direct opposite. For example, if one of the methods reconstructs Proto-Oceanic as having a 51\% chance of having ergative marking, it is not far away from suggesting that this marking is absent. In order to take these types of cases into account the cut-off of 40\%--60\% was set and summarised as ``Half'' results. We can apply the concordance score to this summary statistic as well, as shown in Equation \eqref{eq:accuracy_incl_half}. 

\begin{equation}\label{eq:accuracy_incl_half}
\frac{\text{True Negative + True Positive} + \frac{\text{Half}}{2}}{\text{True Negative + True Positive + False Negative + False Positive + Half}}
\end{equation}

Both scores will be reported, but we will rely mainly on the concordance score with the inclusion of the Half-results. This is because this approach takes into account the possible uncertainty of the half-scores which can be valuable information.

In a similar study of ancestral states of cognate classes, J\"ager and List (\citeyear{jager2018using}) compared three different methods of ASR for lexical data (cognate classes): MP, ML and Minimal Lateral Networks. They found that reconstructions using ML performed the most like the predictions by historical linguists. However, J\"ager and List (\citeyear{jager2018using}) describe the general performance of all the computational reconstruction methods they used as ``poor''. J\"ager and List (\citeyear{jager2018using}) evaluates the methods using F1-scores which are the harmonic means of Precision and Recall \citep{sasaki2007truth}. This way of evaluating performance focusses on True Positives and ignores True Negatives altogether. It was suitable for the study by J\"ager and List (\citeyear{jager2018using}) because they were primarily interested in the presence of cognate classes, which makes disregarding True Negatives admissible. This is not the case here: True Negatives for structural features are meaningful in a different way than the absence of cognate classes. Because of this, we will not report F1-scores in the main text but only in the supplementary material (see Supplementary Material \ref{f1_results} and \ref{math_supp}).\footnote{I am very grateful for mathematical assistance from Stephen Mann in regards to F1-scores including half results calculation.} %The highest (``best'') F1-score in {jager2018using} was 0.79 (Austronesian language sample, Maximum Likelihood), and the worst was 0.44 (Indo-European, Minimal Lateral Networks).

% mutate(F1_score = 2 * ((Precision*Recall)/(Precision + Recall)), 
  %         F1_score_incl_half = 2 * ((Precision_incl_half *Recall_incl_half)/(Precision_incl_half + %Recall_incl_half)) )%>% 
 
In addition, we also test the strength of correlations between agreement with HL and measurements of phylogenetic signal on one hand and the distribution of tips in each state on the other. For this comparison, we are comparing each method separately against the HL-agreement and phylogenetic signal/distribution of states. For this reason, we did not use the above approach of binning results into Presence, Half or Absence but used the predicted values from the method directly instead (see Supplementary Materials \ref{supp:cor_d_HL} and \ref{supp:cor_min_p_HL}).

\FloatBarrier
\subsection{Data}

\subsubsection{The Grambank dataset}
\label{asr:sec:GBcoverage}

The data for the study is taken from the Grambank project \citep{grambank_release}. The Grambank dataset consists of 195 structural features of over 2,400 languages. This dataset includes 280 Oceanic languages. 

%The Grambank project is part of the Glottobank consortium, which is a collaboration between the Max Planck Institute for the Science of Human History in Jena (MPI-SHH), the Australian National University, the Australian Research Council's Centre of Excellence for the Dynamics of Language and the University of Auckland. The project is led by a team of senior linguists (Russell Gray, Simon Greenhill and Quentin Atkinson) and employs student assistants as coders in Kiel, London, Canberra, Uppsala and a few other locations. Coders who have been contributed significantly to the database are included as co-authors of the upcoming release paper {grambank_release}, alongside other contributors. I have personally participated in this project as a coder and as a coordinator.

%The aim of Grambank is to provide a consistently coded set of structural features of the world's languages for research questions relating to history, complexity and more. The dataset will be published openly. 
 
%The Grambank dataset builds on previous typological work by {dunnetal2005, dunn2008, reesinketal2009, dunnreesink2012} and {ntswebsite}. The project has a global focus and the aim is to include all languages in the world that are described for their core grammatical structure. 

% In the work by Dunn, Reesink and colleagues, they were particularly focussed on languages of Oceania and Australia and the prehistory of migrations and contact there. The Nijmegen Typological Survey-project {nts2014; ntswebsite} on the other hand was focussed on African languages.

The questionnaire's 195 questions cover what are often called the ``core domains'' of traditional grammatical description: word order, possession, negation, tense, aspect, mood, deixis, interrogation, comparatives and more. Features are included in the questionnaire if they are easily codable for the majority of the world's languages which have been described grammatically (approx 4,000 languages; see \citealt{hammarstrom2018simultaneous}). This means that rarer features are not included, such as family or region-specific ones. The full questionnaire is found in Appendix \ref{Grambank_features}.

The Grambank dataset is coded by students, research assistants and other collaborators under the supervision of expert linguists. Each feature is accompanied by documentation guiding coders so that the questionnaire is applied as consistently as possible across different languages. For more details on the coding workflow of Grambank, see \citet{slingerland2020coding}. %For further details on the dataset, see Supplementary Material ~\ref{supp:dataset_details}.

There are differences between how grammatical structures are described in the historical linguistics literature and how they are defined in Grambank; for more on this see §\ref{sec:POC_lit_review}.

%It is crucial in a cross-linguistic survey of this kind that the features are applied consistently across all languages of the sample. Within the Grambank-project, we strive towards a high level of consistency between coders. There are many coders employed and we have established work-flows to ensure that the features are applied consistently across languages. New coders are trained in the workflow and linguistic definitions through collaborative coding. Each feature in the questionnaire is accompanied by a helpful and pragmatic definition in a wiki-page. Each feature is also associated with a ``patron'', an expert linguist assigned to a set of features who has the final word should any further clarification be needed or disagreements arise. There are seven patrons in the project: Alena Witzlack-Makarevich, Harald Hammarström, Hannah Haynie, Jeremy Collins, Jay Latarche, Jakob Lesage and myself. All coders in the project are able to converse with each other and patrons through GitHub, an online platform for project coordination and code collaboration. When we are unable to make a coding decision with sufficient confidence, the datapoint is marked as ``?''.

\FloatBarrier
\subsubsection{Data coverage} 
This study is focused on the Oceanic subgroup of the Austronesian language family. The Oceanic subgroup covers almost all languages in Remote Oceania (with the exceptions of Chamorro and Palauan) and large parts of Near Oceania. Figure~\ref{Oceanic_map} from \citet[2]{protooceanicvol5} shows the geographic extent of the major subgroups of the Austronesian language family, with Oceanic covering the largest surface area. Following the language classification of Glottolog 4.5 \citep{glottolog4_5}, there are 522 languages in total in the Oceanic subgroup.

\begin{figure}[ht]
\centering
\includegraphics[width=17cm]{illustrations/ross_pawley_osmond_protooceanic_vol5.png}
\caption{{Map of the Austronesian language family and major subgroups from \citet[2]{protooceanicvol5}}}
\label{Oceanic_map}
\end{figure} 

Not all languages of the Oceanic subgroup have grammatical descriptions, but of those that have one, nearly all are included in Grambank. Table~\ref{GB_coverage_table_island_group} shows the coverage of Oceanic languages in the entire dataset. According to Glottolog, there are 289 Oceanic languages that have a grammar or a grammar sketch. Out of these 180 are included in Grambank. The map in Figure~\ref{GB_austro_coverage} shows the same coverage information, with languages coded for their data coverage status.

\input{"illustrations/plots_from_R/coverage_plots/tables/island_groups_table.tex"}

\begin{sidewaysfigure}[ht]
\centering
\includegraphics[width=\textwidth]{illustrations/plots_from_R/coverage_plots/maps/coverage_map_oceanic.png}
\caption{Map of Oceania, with Oceanic languages coloured for their coverage in Grambank}
\label{GB_austro_coverage}
\end{sidewaysfigure} %#update

The coverage of Grambank data for the Oceanic subgroup is generally better in the East than in the West. However, since we control for genealogical relatedness in our ASR with trees directly, this is less of a problem for our methodology than if we were using traditional probability sampling (cf. \citealt{ross2004morphosyntactic}).

\FloatBarrier
\subsubsection{The trees}
\label{the_trees}
The tree phylogenies used in this study are: 

\begin{enumerate}[label=(\alph*)]
    \item the Maximum Clade Credibility Tree (MCCT) from \citet{grayetal_2009}
    \item a random sample of 100 posterior trees from \citet{grayetal_2009} 
    \item the tree from Glottolog 4.5 \citep{glottolog4_5}\footnote{The tree of Glottolog 4.5 \citep{glottolog4_5} is based on work by \citet{blust_2009, blust_2014} and Blust and Chen (\citeyear{blust_chen_2017}).}
\end{enumerate}

Figure \ref{tree_coverage_oceanic_gray} and Figure \ref{tree_coverage_oceanic_glottolog} show the Grambank coverage of languages over the phylogenies from the \citet{grayetal_2009} MCC tree and the Glottolog tree, respectively. 

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{illustrations/plots_from_R/coverage_plots/tree/Oceanic_tree_desc_status_gray_et_al_tree_mcct.png}
\caption{{Maximum Clade Credibility Tree of Oceanic from \citet{grayetal_2009}, with languages coloured for coverage in Grambank}}
\label{tree_coverage_oceanic_gray}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{illustrations/plots_from_R/coverage_plots/tree/Oceanic_tree_desc_status_glottolog_tree.png}
\caption{Tree of Oceanic from Glottolog, with languages coloured for coverage in Grambank}
\label{tree_coverage_oceanic_glottolog}
\end{figure}

One of the major differences between the trees is that the Glottolog tree does not contain \textit{any} information on branch lengths. All the branches in the Glottolog tree are of the same length, whereas the branches in the \citet{grayetal_2009} trees (both the MCCT and the posteriors) have meaningful branch lengths based on rates of change in the underlying data (basic vocabulary) and calibration points (archaeological dates). This can be seen in the visualisations in Figures ~\ref{tree_coverage_oceanic_gray} and \ref{tree_coverage_oceanic_glottolog}, where the first has varying lengths of branches but the latter all have a uniform length. This has the consequence that some tips in the Glottolog tree are \textit{much further} from the root than others. This is a big disadvantage with this type of tree since it suggests that different amounts of time have passed between the root and the languages at the tips. 

In addition, the Glottolog tree contains more non-binary splits (polytomies) than the \cite{grayetal_2009} trees. Binary splits ought to be more plausible, since it is unlikely that a set of three or more languages are all \textit{exactly} equally related to each other. Polytomies can be a way of signalling uncertainty; when it is not clear how to structure the group, it may be preferably to suggest a polytomy than a less certain binary branching. In the Glottolog Oceanic tree (pruned for matches to Grambank), 10\% of splits are not binary. In the \cite{grayetal_2009} MCC tree, only 3\% are non-binary. Taking into account samples from the posterior is another way of accounting for uncertainty without needing polytomies as much. In the random sample of 100 trees from the \cite{grayetal_2009} posterior, 39 trees had binary splits, and the mean percentage of non-binary splits across all 100 is 0.15\%. Further technical details of the trees can be found in Supplementary Material \ref{supp:tree_details}.

The Glottolog tree contains all the languages in the Oceanic subgroup. Therefore, the coverage per island group that is summarised in Table~\ref{GB_coverage_table_island_group} in the previous section applies to the Glottolog tree as well. However, the \cite{grayetal_2009} trees do not contain all Oceanic languages, but rather 155. Out of these, 132 also occur in the Grambank dataset. %A breakdown of coverage for the{grayetal_2009}-trees per island group is found in table ~\ref{GB_coverage_table_island_group_gray}.

Finally, we are also using a sample of the posterior trees from \cite{grayetal_2009}. Their study yielded 4,200 posterior trees. Tree topologies that are more probable occur more often. By using a set of possible trees instead of just one, we may be able to include diverging historical accounts, which could estimate contact events as well as inheritance. Figure~\ref{densitree_plot} shows a DensiTree visualisation \citep{bouckaert2014densitree} of the 100 trees which are used in this study.

\begin{figure}[ht]
\centering
\includegraphics[width=18cm]{illustrations/plots_from_R/coverage_plots/tree/gray_et_al_2009_100_sample_densitree.png}
\caption{DensiTree \citep{bouckaert2014densitree} visualisation of the 100 random sampled trees from the \citet{grayetal_2009} posterior. Made with the function \texttt{densiTree()} from the R package \texttt{phangorn} \citep{phangorn}}
\label{densitree_plot}
\end{figure}


\FloatBarrier
\subsubsection{Data from historical linguistics on Oceanic proto-language grammar}
\label{sec:POC_lit_review}

Oceanic proto-languages are well-researched in terms of their lexicon and phonology compared to most languages in the world (see, among other publications, the book series on the Proto-Oceanic lexicon; \citealt{protooceanicvol1, protooceanicvol2, protooceanicvol3, protooceanicvol4, protooceanicvol5}). There also exists substantial work done on the grammar of Proto-Oceanic using conventional methods in HL. We have summarised several major works in the field and distilled their research into predictions about Grambank variables in proto-languages. This section gives an overview of the works included and examples of how they have been incorporated into the study.\footnote{Table~\ref{HL_prediction_table_summary} in Supplementary Material \ref{supp:proto_lg_coding_table} lists all of the publications used here as representations for the reconstruction of grammar in Oceanic linguists by conventional historical linguistics means.}

For each of these publications on the grammars of proto-languages, findings have been extracted that support a certain coding in the Grambank questionnaire for each proto-language. For example, \citet[4]{marck2000_encyclo} writes that a causative prefix \textit{*faka-} can be reconstructed for Proto-Polynesian. In the Grambank questionnaire, we have the feature GB155 ``Are causatives formed by affixes or clitics on verbs?''. So, in Proto-Polynesian for the feature GB155, the predicted state from HL is ``1'' (yes/presence). For simplicity, we are only considering four ancestral languages: Proto-Oceanic, Proto-Central Pacific, Proto-Polynesian and Proto-Eastern Polynesian. The choice to focus on these four, in particular, was based on the fact that they are the most well-researched proto-languages in the literature in terms of grammatical features that can be coded for in Grambank. 

%As has been discussed earlier in this paper,  ASR in historical linguistics is usually carried out with words and sounds, but it can also be applied to grammmar. ASR of grammar is controversial because it is not entirely clear what are sounds principles to base the methodology on. The main conflict concerns the nature of the data itself and how cognacy can be determined, which is a necessary precedent for analysis within the Comparative Method-framework. In this paper, we tease our specifically ASR from the toolbox of historical linguistics and borrow methods from biology and cultural evolution in regards to determining validity of the data, see the preivous section \ref{sec:is_it_valid}. 

%{crowley1985common} for example traces the history of a common noun phrase marker \emph{*na/*a} in Oceanic languages and {lynchrosscrowley_proto_grammar_oceanic} discuss word-orders in proto-Oceanic.

%The data in this paper does not track specific forms, as is common when reconstructing proto-languages in historical linguistics (c.f {pawley1973some, crowley1985common, evans2003study}). Instead we use binary features of a typological questionnaire which tracks a large part of ``core" grammar -- the Grambank dataset. (cf. {carling2021reconstructing}) This section outlines some crucial differences between structural data and the kind of data that is typically used in historical linguistics in relation to the present study.

As evident by the example in the previous paragraph, the work on ASR of grammar in Oceanic languages typically concerns specific forms (e.g., \emph{*faka-}) while the Grambank questionnaire targets more abstract features. This means that the Grambank coding of the proto-languages based on conventional HL ASR is not a \textit{precise} rendition of the literature, but a typological interpretation of the historical research. This task is the same as the coding of the extant daughter languages (Tikopia, Paluan, etc.), where we read grammars that describe particular forms, paradigms, etc. and then translate this information into Grambank datapoints. 

When doing ASR in conventional HL, scholars in this field also take into account fossilised forms -- e.g., the common noun marker \textit{-a} fusing to roots in Paamese \citep[141]{crowley1985common} -- and related meanings -- e.g., the hypothesis of \textit{-Cia} changing from a transitivising suffix to a marker of passive voice \citep{hale_1968}; \citep{hohepa_1967}; \citep{hohepa_1969}; \citep{chung1978}; \citep{jonsson1998}. The Grambank dataset, however, (as many other typological surveys) only considers productive patterns and does not include information on specific formal expressions of grammatical phenomena or so-called ``fossils'' which no longer express the function productively.


% {crowley1985common}, {clark1973aspects}, and other schlars whose work we will compare to our results in this paper, typically apply the comparative method to specific formal expressions of structural features (the \emph{na} article, \emph{-Cia} suffix, \emph{faka-} prefix etc). 
 
%Surveys of this kind do not track forms, but abstract features such as ``Does the language mark passive voice?''. This means that two languages can be coded identically for entirely different reasons and without being related. For example, Koasati [koas1236] of Louisiana, USA, and Mokilese [moki1238] on Mwoakilloa in the Federated States of Micronesia are both coded as having a construction for predicative possession of the type ``Topic'' by {wals-2011-117}. However, they belong to entirely different language families and different parts of the world. Their similarity does not necessarily imply shared inheritance. This is unlike cognacy data, where the fact that two languages have cognates in common is direct evidence of relatedness.


As an example of what it means to consider fossils, let us consider markers of definiteness in Oceanic languages. \citet{crowley1985common} investigates ``common noun phrase markers''\footnote{This term is more or less identical to a prenominal definite/specific article.} in Oceanic and finds that in many languages there is a reflex of what is taken to be proto-Oceanic \textit{*na/*a}, but in some languages there is another marker with a different origin (M\={a}ori \textit{te}, for example). In \citeauthor{crowley1985common}'s study, languages where there is no common noun phrase marking whatsoever and those with a marker that is not cognate with \textit{*na/*a}, are both included in Type 1 (see Figure~\ref{fig:crowley_map}). These languages are contrasted with those that have retained some kind of reflex of \emph{*na/*a} (Types 2--4 in Figure~\ref{fig:crowley_map}). This means that we can distinguish languages which have retained the proto-form from those that have not, but not languages which have a common noun phrase marker from those that do not.

\begin{figure}[!ht]
\centering
\includegraphics[width=15cm]{illustrations/crowley_1985_map.png}
\caption[Map of four different types of common noun phrase markers in Eastern Oceanic from Crowley(1985).]{Map of four different types of common noun phrase markers in Eastern Oceanic from \citet[162]{crowley1985common}. Type 1: absence of common noun phrase marker or marker is not a reflex of \textit{*na/*a}; Type 2: non-productive system involving a reflex of \textit{*na/*a}; Type 3: productive marking involving \emph{*na /*a} as a prefix that is regularly separable from the noun; Type 4: productive marking involving \textit{*na/*a} generally existing as a free-standing marker. Areas with cross-hatching show a distribution of both Type 1 and Type 2 systems, with definite areas being difficult to delineate on a map of this scale}
\label{fig:crowley_map}
\end{figure}

In contrast, the corresponding feature in Grambank is GB022: ``Are there prenominal articles?'' (see Figure~\ref{fig:gb022_map}). Languages that have \textit{te} (like M\={a}ori) or reflexes of \textit{*na/*a} as articles before the noun both count as ``yes'' (1) for GB022 and those that have no prenominal marker as a ``no'' (0). This Grambank feature splits Crowley's Type 1 into two categories and combines all the languages with reflexes of \textit{*na/*a} and \textit{te} (or other markers) into one category with no distinction made for the form. We can therefore distinguish those that have a prenominal article from those that do not, but we cannot tell apart those which have retained the proto-form \emph{*na/*a} and those which have not. 
%Since many reconstructions of grammar in historical linguistics rely on particular forms, this is an important difference. This does not matter for features such as word order.

\begin{figure}
\centering
\includegraphics[width=16cm]{illustrations/plots_from_R/coverage_plots/maps/map_GB022.png}
\caption{{Map of Austronesian languages for GB022 ``Are there prenominal articles?''. Yellow = ``yes''; Purple = ``no''}}
\label{fig:gb022_map}
\end{figure}

This is a difference in the kind of data that goes into the analysis, not a difference in the analytical methods themselves (compare with tasks a and c in Figure \ref{fig:HL_tasks}, respectively). While this principal difference is important, it should also be noted that Grambank feature GB022 has strong phylogenetic signal (negative D-estimates which are statistically similar to 0; see §\ref{sec:is_it_valid} for details). This gives us confidence that we can move ahead.

As we have seen, Grambank data are composed of abstract features such as ``is a grammatical distinction made between X and Y?''. This makes it different from most ASR-studies of grammar in HL, which tend to be more focused on particular grammatical expressions such as morphemes. Two languages can be coded alike in Grambank and many other typological surveys, but not share ancestry. It is also possible that such abstract features track inheritance beyond the particular forms. \citet[503]{ross2004morphosyntactic} notes that a particular structure of the pronominal system of Mokilese is maintained, despite the formal markers being continuously replaced. He argues that there are discourse-related reasons for maintaining this system and that the interaction between this construction and the rest of the grammar is such that the distinction is maintained. When particular markers are lost in this system, new ones appear in their place.\footnote{\citet{ross2004morphosyntactic} also notes that \citet{goddard1993algonquian} observes similar patterns in Algonquian languages.} This may be true of more features, and in such cases, languages can share a grammatical structure due to inheritance but not have the same particular forms. \citet[400--401]{evans2003study} also notes that while reconstructions based on lexical data are seen as more secure, they're not always possible or practical. It can be beneficial and necessary to aim to reconstruct patterns. % In addition, in many instances -- particularly within families -- abstract features such as 'GB022: \emph{Are there prenominal articles?}' are in fact correlated with specific forms even if the forms are not explicitly being tracked.

In the Grambank project, research assistants read published grammatical descriptions and extract information such that it fits with the definitions of our typological questionnaire (see Supplementary Material \ref{Grambank_features}). This survey of the literature on Proto-Oceanic grammar is essentially the same task. Just as with the literature on reconstructed languages, scholars sometimes disagree on the nature of contemporary languages and how they should best be analysed. It is up to the coder to make calls on which analysis to apply, what can be inferred from the literature and what should be left as unknown. It is possible to squeeze even more findings out of these publications; I have tended to be conservative in my interpretations the literature on Oceanic proto-languages. Out of the 201 (binarised) features in our questionnaire, 33\% (67) were answerable for Proto-Oceanic given the existing studies in HL. The average completion per language in the whole of the Grambank dataset is 85\% (170). 

Overall, the literature on ASR of grammar in Oceanic suggests that Proto-Oceanic was a language with: a prenominal definite/specific article \citep[136]{crowley1985common}; a distinction between inclusive and exclusive first person pronouns (\citealt[112]{pawley1973some}; \citealt[184]{crowley1985common}; \citealt[500]{ross2004morphosyntactic}; \citealt[67, 75]{lynchrosscrowley_proto_grammar_oceanic}); no gender distinctions in pronouns \citep[498]{ross2004morphosyntactic}; a dual number category in pronouns (\citealt[498]{ross2004morphosyntactic}; \citealt[69]{lynchrosscrowley_proto_grammar_oceanic}; \citealt[173]{pawley1973some}); a distinction between alienable and inalienable possession\footnote{A distinction can be made between three different kinds of possessive classification: alienable/inalienable, direct/indirect and dominant/inactive. For the purposes of Grambank and this study, these are treated as similar enough to be included in the same category.} \citep[69]{lynchrosscrowley_proto_grammar_oceanic}; prepositions (\citealt[167]{pawley1973some}; \citealt[498]{ross2004morphosyntactic}); subject proclitics and object enclitics on the verb (\citealt[498-499]{ross2004morphosyntactic}; \citealt[83]{lynchrosscrowley_proto_grammar_oceanic}); possessive suffixes on the possessed noun (\citealt[495]{ross2004morphosyntactic}; \citealt[155]{pawley1973some}); and a transitivising suffix on verbs (\citealt[352]{pawley1970change}; \citealt[171]{pawley1973some}; \citealt[80, 92]{lynchrosscrowley_proto_grammar_oceanic}). All studies cited are found in Table \ref{HL_prediction_table_summary} in Supplementary Material \ref{supp:proto_lg_coding_table}.

Most of the time, scholars of Proto-Oceanic are in agreement in their predictions. For example, \citet[142]{pawley1973some}, \citet[292]{ross2007two}, \citet[xiii, 125]{clark1973aspects} and \citet[89]{lynchrosscrowley_proto_grammar_oceanic} all propose that Proto-Polynesian had a construction marking prohibitive that was different from declarative negatives. However, there are some disagreements (as discussed in §\ref{sec:hl_disagreements}). In total, there are 115 datapoints where there is either just one publication supporting the statement or -- if there were several -- they agreed. There are three datapoints where there is disagreement (all of which concern alignment of either Proto-Polynesian or Proto-Central Pacific).

\FloatBarrier
\section{Results}
\label{results}
We are examining results from three approaches in total: (a) Maximum Parsimony (MP), (b) Maximum Likelihood (ML) and (c) Most Common value in daughter languages (MC). For (a) and (b), we are also using three different trees: (i) Glottolog, (ii) \citet{grayetal_2009} MCC tree and (iii) the mean values of reconstruction of a random selection of 100 (out of 4,200) trees in the Bayesian posterior of \citet{grayetal_2009}. That gives us 7 results, in total.

The results are divided into three subsections: §\ref{sec:results_concorance}, concurrence with conventional historical linguistics; §\ref{sec:new_predictions}, new predictions; and §\ref{sec:conflicts} disagreements among historical linguists.

\subsection{Concordance between traditional historical linguistics and computational methods}
\label{sec:results_concorance}

%The match between languages in Grambank and the Gray et al-tree is 112, meaning that results with less than 56 tips are ignored. %#update


%The full table of all predictions (excluding those relating to conflicts) and all results per feature, tree and method can be found in table~\ref{asr_table_appendic} in appendix \ref{ASR_comparison_table}. 

Table \ref{True_post_results_table} shows the number of False, Positive and Half results for each method and tree.\footnote{There was one feature for the ML analysis of the \citet{grayetal_2009} trees where the computation could not be carried out because all the languages had the same value. In such cases, the function used (\texttt{corHMM} from the R-package \texttt{corHMM}; \citealt{R-corHMM}) gives an error because it cannot compute the rates matrix. This is why the total is 114 for ML * \citet{grayetal_2009} trees.} Overall, all methods have a large amount of True Negative/Positive results compared to False Negative/Positive (i.e., the vast majority of the time they reconstruct the same grammatical features as suggested by traditional historical linguistics literature). One of the most striking features in Table \ref{True_post_results_table} is the large amounts of Half-results for the MC method (the method where we simply count directly what is most common in all daughters). This means that there were many instances where this approach would not confidently be able to predict a presence or absence. It is precisely in such instances that a reliable tree and more sophisticated methodology are worthwhile in order to construct the previous states well; looking at frequency alone is not sufficient.

\input{"illustrations/plots_from_R/results/table_false_pos_etc.tex"}

Given these counts, we can calculate the concordance scores (see §\ref{result_calc_section}). These are displayed in Figure \ref{barplot_facet_results}. A score of 1 means identity with predictions of historical linguists and 0 means entirely dissimilar from them.

\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{illustrations/plots_from_R/results/barplot_facet_scores_exclude_f1.png}
\caption{Barplots of concordance scores of each method}
\label{barplot_facet_results}
\end{figure}

The inclusion of the half-results has the effect of evening out the differences between the performance of the different methods. The concordance scores which include half-results for each method are more similar to each other.

The method that performs most similarly to historical linguists is MP * the Glottolog 4.5 tree. The Glottolog 4.5 tree has a significant issue; it has no branch lengths and the topology is composed of a combination and compromise from several different sources as opposed to a principled and systematic investigation of data. Parts of the tree are suggested by different scholars, which means that different clades are not necessarily comparable. It does have an advantage though: the sheer number of languages it includes. The overlap between languages included in Glottolog 4.5 and Grambank is greater than for the \citet{grayetal_2009} trees. It is possible that it is this sheer number of tips that gives it a greater concordance with historical linguists' predictions. The results also suggest that it is possible that historical linguists, in these specific studies, do not necessarily take into account branch lengths because there is higher agreement with the Glottog 4.5 tree (a tree without branch lengths) * the MP method (a method that disregards branches altogether).

Overall, however, the methods perform similarly. There is very little that differentiates the different methods -- they are giving very similar results and all show a high degree of agreement with conventional historical linguistics. For a more detailed example of the few cases where they disagree, see Appendix \ref{supp:GB133_detail}.
% Out of the trees of {grayetal_2009}, the random 100 posterior samples perform every so slightly better than the plain MCC-tree. This may indicate that they are possibly picking up some relevant history not represented in the MCC-tree, such as contact. The difference is very small though.

We also carried out an analysis on whether phylogenetic signal \citep{fritz2010selectivity} or the distribution of tips in either state predicts the level of agreement between each method and conventional HL (see Supplementary Materials \ref{supp:cor_d_HL} and \ref{supp:cor_min_p_HL}). The results show that there is no relationship between phylogenetic signal (as measured by the D-estimate; \citealt{fritz2010selectivity}) and concurrence with HL, but that there is a weak to moderate correlation with prevalence in daughter languages. If almost all languages have a given feature, HL and the computational methods tend to both reconstruct the same state. However, if the feature values vary more, the agreement is reduced. This is expected; if most of the languages have the same profile, it is not surprising that the ancestral nodes are reconstructed the same despite differing methods.

In §\ref{sec:is_it_valid} we suggested that features with D-estimates dissimilar to Brownian evolution according to the D-estimates' p-values may not be suitable for ASR. The Grambank features in this category did not show any different behaviour from the rest in terms of agreement with HL (see Appendix \ref{supp:cor_d_HL}). Like the other features, they did not show a significant correlation between agreement with HL and D-estimate. The vast majority agreed with HL. This may tell us that either: (a) there is no robust relationship between the agreement between methods and phylogenetic signal or (b) this particular measure of phylogenetic signal is faulty (for example, that Brownian motion is not a reasonable assumption). Future studies should delve further into different kinds of measurements of phylogenetic signal and their potential applicability to linguistic data.

We can also compare the methods to each other. Figure \ref{heatmap_accuracy_score_methods} shows the pairwise concurrence (including half-results) scores between all of the methods. All of the computational methods agree more with each other than any of them do with conventional HL. The reason is most likely related to not only the difference in methodology but also the underlying data. All of the computational methods use Grambank data and partially the same trees, whereas the underlying language-level data and tree structure in conventional HL ASR are different. For the purposes of this study, the HL literature has been translated into Grambank datapoints, but there is likely to be some discrepancy in the definitions of grammatical concepts and how to apply them to each and every language in the dataset. Reconstruction in conventional HL does not always spell out the specifics of the tree structure in terms of particular splits and branches but is rather based on broader subgroups -- this can also be a contributing factor.

%For example, the underlying data of the map of noun markers in Oceania in Fig \ref{fig:crowley_map} from {crowley1985common} 

\begin{figure}[ht]
\centering
\includegraphics[width=17cm]{illustrations/plots_from_R/results/dist_heatmap_all_methods.png}
\caption{Heatmap of accuracy score (including half) between reconstruction, per tree and method. Dark blue = high concurrence; Light green = low concurrence}
\label{heatmap_accuracy_score_methods}
\end{figure}


\FloatBarrier
\subsection{New predictions}
\label{sec:new_predictions}

Besides the predictions made by historical linguists, we can also explore what else has strong support in our computational reconstructions that is not explicitly mentioned in the literature (see Supplementary Material \ref{supp:proto_lg_coding_table}). There are 111 features that are predicted as present in the four proto-languages by the two methods (MP and ML) with all three trees (Glottolog, \citealt{grayetal_2009} -- MCCT and \citealt{grayetal_2009} -- posteriors); i.e., six times. For example, they propose that Proto-Oceanic has inclusory constructions, Proto-Central Pacific uses verbs for admoninal property attribution (``adjectives'') and Proto-Polynesian has numeral classifiers. 107 of these 111 predictions were also the most common in the daughter languages, meaning that more than 60\% of the languages possessed the trait. There is therefore little surprise that all the methods agree. However, there are four cases where both MP and ML (for all three trees) agree on the presence of a particular proto-language structural feature despite it not being the most common (see Table \ref{table_extra_predictions_four}). This is where the tree structure comes into play and adds information beyond frequencies.

\input{"illustrations/plots_from_R//results/extra_predictions_minus_MC.tex"}



%Many of these are probably not surprising to most historical linguists working on Oceanic languages, but they were not explicitly predicted in the sources surveyed for this study.

%three out of the four sets of results predicted that the order of numeral and noun is N-Num, all tests supported that ``adjectives'' in Proto-Central Pacific behaved like verbs when used predicatively, and all tests also supported that Proto-Polynesian had three or more distance contrasts among demonstratives. 
\FloatBarrier
\subsection{Where the conflicts are: Ergativity}
\label{sec:conflicts}
The nature of the alignment system of Proto-Polynesian and Proto-Central Pacific is contested (see §\ref{sec:hl_disagreements}). Grambank has two features that pertain to these disagreements:
%{clark1973aspects} posits, primarily on the basis of Maximum Parsimony, that Proto-Polynesian was ergative whereas {hale_1968}, {hohepa_1967,hohepa_1969}, and {chung1978} argue that it was accusative (while they suggest different historical pathways, they agree that Proto-Polynesian was nominative-accusative). 


\begin{itemize}
\item GB408 ``Is there any accusative alignment of flagging?''
\item GB409 ``Is there any ergative alignment of flagging?''
\end{itemize}

It is entirely possible for a language to be entered into the database as ``yes'' for both of these (i.e., from the perspective of Grambank languages are not wholly ``ergative'' or ``accusative''; they can have both ergative and accusative flagging simultaneously). This makes it possible for us to prove both \citet{chung1978} and \citet{clark1973aspects} ``right''. The results can come out such that Proto-Polynesian had both accusative \textit{and} ergative alignment flagging. Table \ref{conflict_table} shows a summary of the predictions from the different historical linguists in regard to the alignment of Proto-Polynesian and Proto-Central Pacific.

\newcommand{\pb}[1]{\parbox[t][][t]{1\linewidth}{#1} \vspace{3.5pt}}

%label = conflict_table
\input{"illustrations/plots_from_R/results/table_conflicts_HL.tex"}

The results in fact come out strongly in favour of the proposal by \citeauthor{clark1973aspects}. Table \ref{conflict_results_table} shows that MP, ML and MC all reconstruct presence for ergative flagging in Proto-Polynesian. There is disagreement on the matter of nominative-accusative marking, with the MP results all suggesting absence but the ML and MC giving a half-result.


%label = conflict_results_table
\input{"illustrations/plots_from_R/results/table_conflicts_results.tex"}

As was noted earlier in §\ref{sec:POC_lit_review}, the computational reconstructions differ from those arrived at through the conventional ASR in HL primarily because the data used in this study are the more abstract presence or absence of structural features, whereas historical linguists use specific concrete forms instead (cf. \citealt{crowley1985common}). Besides the parsimony principle (as laid out by \citealt[19]{clark1973aspects}), expert historical linguists also take into account the plausibility of the proposed proto-language and the chain of changes posited \citep{chung1977aspects}. It is not possible for the computational reconstructions to take these assumptions into account without having them formally described and introduced into the model, which is not possible at this time. This may be the reason for the lack of support for \citeauthor{chung1977aspects}'s theory; the crucial information that underpins it is not accounted for in the analysis.

Given the topology of the trees used in this study, where the ergative-flagging language Tongan is always attached to the Proto-Polynesian root at a higher level than Eastern Polynesian languages (cf. Figure \ref{poly_GB409_tree}), it is very likely that GB409 would be reconstructed as present for Proto-Polynesian. As \citeauthor{clark1973aspects} points out, this is the most parsimonious solution. However, GB408 (accusative) could still be reconstructed for Proto-Polynesian. The reasons for this may lie in different definitions of what counts as nominative-accusative or neutral in different descriptions, and/or plausibility of changes/states. As has been discussed earlier, it was not possible to include plausibility as a factor in this study.

The proposals of \citet{hale_1968}, \citet{hohepa_1967, hohepa_1969} and \citet{chung1978} also involve the reconstruction of passive voice that relates to the development of the ergative systems. They suggest different pathways by which languages can develop from a nominative-accusative system to an ergative-absolutive one that rely on changes in the specifics of the passive voice construction that we, unfortunately, do not track. Given our data, which simply record the presence of a productive passive voice marker on the verb, we are not able to scrutinise the three precise theories in greater detail. The results largely support the hypothesis that Proto-Eastern Polynesian had a passive voice marker and that Proto-Oceanic and Proto-Polynesian did not. This can be seen as partial support for the proposals by \citet{hale_1968, hohepa_1967, hohepa_1969} and \citet{chung1978}.

Concerning the alignment of Proto-Central Pacific, all the results (save the MC model) predict an absence of ergative-marking. This is likely to be because Rotuman [rotu1241], West Fijian [west2519] and Fijian [fiji1243] are all coded as 0 for this feature and they split off early from the Proto-Central Pacific node. This supports the argument put forward by \citet{ball2007ergativity}. Similar to the Polynesian case, given the tree structure, it is difficult for the computational approaches to produce another result without more information on the particulars of the development of alignment systems or possible contact.

\FloatBarrier
\section{Conclusions}
\label{conclusions}
We have investigated the history of structural features of Oceanic languages to examine how computational ASR methods compare to reconstructions by historical linguists, including contributing to the debate on alignment in Oceanic proto-languages. This paper has compared different methodologies of ASR, both conceptually and practically (§\ref{sec:results_concorance}). First we go through the conclusions based on the conceptually comparison and then the results from the specific study of grammar in Oceanic languages.

Table \ref{methods_pros_cpns} summarises the pros and cons of the different methods conceptually, as discussed in §\ref{sec:ars:metod:hist}, §\ref{sec:asr_methods} and §\ref{sec:MP_ML_MC}.

\begin{table}[ht]
\centering
\caption{Summary of conceptual pros and cons of the ASR-methods}
\label{methods_pros_cpns}
\begin{tabular}{m{4cm}m{5cm}m{5cm}}
  \toprule
\textbf{ASR-Method} & \textbf{Pros} & \textbf{Cons} \\ \midrule
Conventional HL &  widely used and attested; human-friendly; takes into account complexities regarding item- and language-specific nuance and context &  may ignore branch lengths; plausibility/rates of changes and plausibility of combined states are under-specified which leads to hard-to-resolve conflicts; possible: assumes slowest rate = most plausible rate\\ \midrule
Maximum Parsimony &  easy to understand; consistent; explicit  & ignores branch lengths; assumes slowest rate = most plausible rate; does not allow asymmetric transition rates\\ \midrule
Maximum Likelihood & consistent; explicit; takes into account branch lengths; dynamically estimates rates; can take further input such as priors on root state, rates, etc. & requires more knowledge of computational mathematics \\ \midrule
Most Common & easy to understand & ignores the tree altogether; estimates no rates  \\
\bottomrule
\end{tabular}
\end{table}

Given the basic assumption that branch lengths matter (languages that are spoken at a similar time in history ought to have a similar distance to the shared ancestral language), we should choose methods that take that into account. If conventional HL ASR does take branch lengths into account, it is often under-specified. It is desirable to be as consistent and explicit as possible. This enables others to interrogate the research and replicate. Computational methods allow us to be explicit about each analytical choice, which is difficult to do with conventional approaches. Given the importance of taking into account branches and the desirability of not assuming the slowest rate of change, ML is the best approach out of these four.

Table \ref{trees_pros_cons} compares the pros and cons of the different phylogenies of this paper.

\begin{table}[ht]
\centering
\caption{Summary of conceptual pros and cons of the trees}
\label{trees_pros_cons}
\begin{tabular}{m{3cm}m{3.5cm}m{3.8cm}m{3.8cm}}
  \toprule
\textbf{Tree} & &\textbf{Pros} & \textbf{Cons} \\ \midrule
Glottolog 4.5 & \includegraphics[width=3.5cm]{illustrations/plots_from_R/coverage_plots/tree/Oceanic_glottolog_tree_bare.png} &includes all Oceanic languages & has no branch lengths; possibly inconsistent subgrouping; many polytomies (10\%); lowest proportion of D-estimates similar to 0 \\
\midrule
\citet{grayetal_2009} - MCCT & \includegraphics[width=3.5cm]{illustrations/plots_from_R/coverage_plots/tree/Oceanic_gray_et_al_tree_mcct_bare.png} &has branch lengths; is based on explicit lexical data; transparent methodology at each step; fewer polytomies (3\%) & includes fewer languages \\
\midrule
\citet{grayetal_2009} - random sample of 100 from posterior &  \includegraphics[width=3.5cm]{illustrations/plots_from_R/coverage_plots/tree/gray_et_al_2009_100_sample_densitree.png}& has branch lengths; is based on explicit lexical data; transparent methodology at each step; much fewer polytomies (0.15\%); encompasses more variation than MCCT; highest proportion of D-estimates similar to 0 & includes fewer languages; takes longer time to calculate over\\
\bottomrule
\end{tabular}
\end{table}

\FloatBarrier

Once more, given that branch lengths matter if we want to understand the past, we ought to go with the trees from \cite{grayetal_2009}. After all, an equal amount of time has passed between the existence of a proto-community to today's extant languages, and we take our trees to estimate that history. It is possible that some languages are more conservative than others in their sounds, words or grammar, but in such cases, we should let the models figure that out rather than set all branches to the same length. When it comes to ancient languages, like Latin, Akkadian etc., it makes sense to place these at a closer distance to the root (as done for example in \citealt{carling2021reconstructing}). However, the differences in root-to-tip distances that a tree like Glottolog suggests for Oceanic seem extreme (see Figure \ref{fig:branch_lengths} in Supplementary Material \ref{supp:tree_details}). 

While the MCCT is a practical summary of the 4,200 posterior trees, sampling over the actual set of posterior trees is preferable since it incorporates uncertainty in a better way and involves fewer polytomies.

Conceptually, the most reliable results \textit{a priori} are those derived from ML * random sample over posterior.

Now to the practical comparison, how does the computational approaches compare to conventional HL? Overall, there is a high degree of concordance with reconstructions from expert historical linguists and all approaches. Reconstructions by both MP and ML agreed to a very large extent with the findings from HL. This suggests that the mechanisms at work in HL reconstruction may be similar to the concepts underlying the computational methods presented in this paper. The agreement was the highest when most of the languages had or lacked a feature (see Supplementary Material \ref{supp:cor_min_p_HL}), but it was generally high also when there was more variability.

The preferable method conceptually, ML * random sample over \citet{grayetal_2009} posterior, did not have the highest concordance (including half-results) score with HL, at 0.87. The variation between the results was not large, however. The method that was the most similar to conventional HL, MP * Glottolog, achieved a concordance of 0.9. The Glottolog tree contained more matches to Grambank datapoints, which is probably why it outperformed the \cite{grayetal_2009} trees in concordance with conventional HL.

The methods which do not take into account branch lengths (MP and MC) achieve a somewhat higher concordance with HL predictions. This is potentially troubling since it seems a sound principle that branch lengths in trees matter.

However, the general concordance between the outcomes of the different methods studied here gives us confidence that computational approaches are not so foreign to HL as they first may appear. 

The classical HL toolkit is well-developed in terms of subgrouping, but for future analysis, it would be beneficial to develop a framework regarding branch estimation as well. Pawley (personal correspondence) notes that most of the subgrouping done in HL tends to be at the lower level, which suggests that further work on deeper relationships is also needed in order to improve the overall tree-structure (unless we have cause to believe in more community splitting events in recent time compared to long ago). Branch-estimation need not be the same as suggesting precise dates; with reasonable priors and constraints we can still produce a result that signals uncertainty where it is prudent. While it is difficult to estimate rates of change, historical linguists do have knowledge that may rein in analysis, avoiding fantastically slow or fast rates.

Computational methods need not be in conflict with conventional approaches -- the two can be complementary. There is certainly room for improvements in computational approaches based on knowledge from classical HL. When there were disagreements among linguists in regard to the structure of proto-languages, we saw more clearly the impact of the lack of information on the plausibility of changes and combinations, as well as contact-induced change. Currently, it is not possible to include information on these parameters directly into the computational ASR models, because it has not been formalised in such a way that it can be included. If more work was dedicated to formalising such knowledge this may be possible in the future. For example, it is possible to supply ML ASR with a rates matrix that represents the plausibility of changes from one state to another \citep[8--9]{R-corHMM}. It is also possible in other computational approaches to fix certain node states and study what the implications are.

%These results can be interpreted to mean that we have reasons to trust in the results of computational approaches to ASR in linguistics. 

%This means that we have support for using conclusions regarding rate of change etc from the computational methods to estimate knowledge of historical linguists. This can aid us in making the implicit explicit. Whether or not the predictions from classical historical linguistics are correct or not is a different matter, which should be investigated by assessing the soundness of the principles at play and comparing with other evidence.


%but the estimation of branch lengths has received less attention. It is not necessary to ``do dates'' (cf. \citet[371]{greenhill2015evolution}) precisely to make improvements here, relative chronology that is not tied to specific dates is also 

%\cite{mcmahon_2006}
%This need not mean a return to glottochonology, this appears to be a misguided and overly simplistic approach , there are other alternatives.

The future of research on the history of languages probably lies in the combination of human and computational labour. Curating lexical cognate data \citep{list2022lexibank} and constructing trees \citep{grayetal_2009} still rely on teams of expert linguists annotating word-lists for cognacy. Methods are being developed for automatic cognate detection (cf. \citealt{list2017potential}), but they are not yet ready to replace the vast human knowledge and experience of the experts in HL. However, once cognate classes, regular sound correspondences and structural features are identified, the work then turns to reconstructing history (subgrouping or constructing trees/networks) and ASR (cf. Figure \ref{fig:HL_tasks}). For these tasks, there are suitable computational methods that can be applied, such as those in this paper and others (cf. \citealt{greenhill2015evolution}; \citealt{gray_greenhill_defend_bayes}; \citealt{joy2016ancestral}). Research into linguistic history can be greatly improved and streamlined by computational tools, which in turn can be given sensible priors and parameters to produce more reliable results in future joint ventures between classical and novel methods.

In order to improve these methods, we should attempt to include the knowledge that historical linguists have about plausibility of changes, harmonics of traits and contact events. Scholars of Oceanic languages have also acquired an immense knowledge of the languages, cultures and societies of the Pacific. This is why their research is so valuable and trusted. Some or all of this kind of information can be incorporated to guide computational methods, for example as priors in models. These priors should not be given the power to entirely constrain the outcomes, but guide the conclusions the method reaches given the data. In order for this to happen, more information needs to be made explicit in HL studies.

It is no doubt difficult to convey this wealth of contextual information in each and every academic paper. The task becomes more complex when we need to aggregate the knowledge and make it comparable and consistent across publications. Nevertheless, this is where I believe that the path of scientific discovery leads us next -- computers and humans together.

Furthermore, it is also desirable that computational methodologies and phylogenetics be made more accessible to the wider linguistics community and incorporated into HL education. It is my perception that there is at times a disconnect between newer and classical approaches in this space, which is unnecessary and even detrimental. It is my hope that this paper has made some advancements in both introducing historical linguists to some concepts in computational approaches to ASR and introducing non-linguists to ASR in HL more generally.

The more methodology and analytical choices are made explicit, the easier it is to assess the soundness of a study, replicate it and improve upon it. There are areas of this study that I look forward to receiving feedback on so that we can advance together as a field. This study aims at increasing the transparency of both the principles of reconstruction in classical HL and the corresponding computational approaches. Hopefully, this study (alongside \citealt{carling2021reconstructing} and \citealt{goldstein_2022}) can be a starting point for more joint ventures into our cultural past.




%In addition, we also need to encourage co-operation between traditional historical linguists and linguists applying new methods, as exemplified in this paper, when it comes to estimating branch lengths. Many trees proposed in classical studies of historical linguistics do not necessarily 

%One of the key pieces of information that is missing from this analysis is plausibility of changes and combinations of features.

%Within Oceanic historical linguistics, there exists a debate regarding the nature of the alignment system of Proto-Polynesian. The results of this study support the analysis that it was ergative. However, since the computational reconstructions are unable to take into account considerations of plausibility, which is the main difference between the different proposals, this cannot be taken as hard evidence. Further work in this area should seek to incorporate information about plausibility in order to increase the reliability of this result.m

%explicit information on plausibility of rate of change and combinations of traits
%ways of estimating contact events
%models of history (trees/networks) with meaningful branch/edge lengths
%more training of computational methods to historical linguistics students
%more carefully coded data from HL to input to reasonable computational models

\FloatBarrier

\section*{Funding information}
The research leading to this paper has received funding from the Department of Linguistic and Cultural Evolution at the Max Planck Institute for Evolutionary Anthropology, the School of Culture, History and Language at the Australian National University and from the Australian Research Council through The Wellsprings of Linguistic Diversity Laureate Project (awarded to Professor Nicholas Evans 2014-2018) and the Centre of Excellence for the Dynamics of Language (CoEDL).

\newpage
\section*{Acknowledgements}
I am fortunate enough to have colleagues in academia who have been generous and helped me with technical matters and working through methodology conceptually, these are: Stephen Mann, Angela Chira, Jordan Brock, 華夏 Xià Huá, Cara Evans, Benedict King, Gerd Carling, Chundra Cathcart, Cristian Juárez, Viktor Martinović, Robert Tegethoff, Natalia Chousou-Polydouri, David Goldstein, Sandra Auderset, Russell Gray and Hannah Haynie. Mary Walworth has been very helpful in reviewing the Grambank coding of Oceanic proto-languages. I am also grateful to the two anonymous reviewers, editors and proof-readers at Diachronica for their valuable feedback and to my former PhD supervisors Andrew Pawley, Nicholas Evans, Mark Ellison and Simon Greenhill who also provided valuable commentary. Any mistakes and misconceptions that remain are my own.

%\section*{Abbreviations}
%A list of abbreviations used in the text should appear here.


\section*{Abbreviations}
\begin{tabular}{p{3cm} p{10cm} }
ASR & Ancestral State Reconstruction\\
FN & False Negative \\
FP & False Positive \\
HL & Historical linguistics\\
MC & Most Common \\
MCCT & Maximum Clade Credibility Tree \\
ML & Maximum Likelihood \\
MP &Maximum Parsimony \\
TN & True Negative\\
TP & True Positive \\
\end{tabular}

\bibliographystyle{unified}
\bibliography{ASR_Oceanic}

\newpage
\section*{Address of author}
Hedvig Skirgård\\
%E-mail: hedvig\\_skirgard\begin{math}@\end{math}eva.mpg.de
Department of Linguistic and Cultural Evolution\\
Max Planck Institute for Evolutionary Anthropology\\
\textsc{Deutscher Pl. 6, 04103}
Leipzig, Germany\\
\textit{hedvig\_{}skirgard@eva.mpg.de}\\
\url{https://orcid.org/0000-0002-7748-2381}


\newpage


\textbf{Zusammenfassung:}
Ancestral State Reconstruction (ASR) ist ein wesentlicher Bestandteil der historischen Linguistik (HL). Konventionelle ASR in der HL basiert auf drei Grundprinzipien: möglichst wenige Änderungen des Baumes, Plausibilität von Änderungen und Plausibilität der resultierenden Protosprachen. Dieser Ansatz weist einige Probleme auf, insbesondere die Definition von plausibel und die Nichtberücksichtigung der Länge von Zweigen. Die vorliegende Studie vergleicht den klassischen Ansatz von ASR konzeptionell und praktisch mit computergestützten Werkzeugen (Maximum Parsimony und Maximum Likelihood). Computergestützte Modelle haben den Vorteil, dass sie transparenter, konsistenter und reproduzierbarer sind, und den Nachteil, dass differenziertes Wissen und Kontext nur begrenzt berücksichtigt werden. Anhand von Daten aus der Grambank-Datenbank, die grammatische und strukturelle Merkmale beinhaltet, vergleiche ich Rekonstruktionen der Grammatik der ozeanischen Ursprungssprachen aus der historischen linguistischen Literatur mit solchen, die mit computergestützten Werkzeugen erzielt wurden. Die Ergebnisse zeigen, dass es ein hohes Maß an Übereinstimmung zwischen Ergebnissen aus manuellen und computergestützten Ansätzen gibt, wobei die klassische HL tendenziell eher mit Ansätzen übereinstimmt, die die Länge von Zweigen ignorieren. Die explizite Berücksichtigung von Zweiglängen ist konzeptionell fundierter, daher sollte sich die HL mit der Verbesserung der Methoden in dieser Richtung befassen. Eine Kombination aus computergestützten Methoden und qualitativem Wissen ist künftig möglich und wäre von großem Nutzen.

\textbf{Résumé}
La reconstruction de l'état ancestral (ASR) est une partie essentielle de la linguistique historique (HL). L'ASR conventionnel en HL repose sur trois principes fondamentaux : le moins de changements sur l'arbre, la plausibilité des changements et la plausibilité des combinaisons de caractéristiques résultantes dans les proto-langues. Cette approche présente quelques problèmes, en particulier la définition de ce qui est plausible et l'ignorance des longueurs de branche. Cette étude compare l'approche classique de l'ASR aux outils informatiques (Maximum Parsimony et Maximum Likelihood), sur les plans conceptuel et pratique. Les modèles informatiques ont l'avantage d'être plus transparents, cohérents et reproductibles, et le désavantage de manquer des connaissances et des contextes nuancés. À l'aide de la base de données structurelle Grambank, je compare les reconstructions de la grammaire des langues océaniennes ancestrales de la littérature linguistique historique à celles réalisées par des moyens informatiques. Les résultats montrent qu'il existe un degré élevé d'accord entre les approches manuelles et informatiques, avec une tendance pour la HL classique à s'accorder davantage avec les approches qui ignorent les longueurs de branche. La prise en compte explicite des longueurs de branche est plus appropriée du point de vue conceptuel. En tant que tel, la linguistique historique devrait s'engager dans l'amélioration des méthodes dans cette direction. Une combinaison de méthodes informatiques et de connaissances qualitatives est possible à l'avenir et serait très bénéfique.


\end{document}
